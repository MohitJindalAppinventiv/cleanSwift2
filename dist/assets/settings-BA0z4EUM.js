import{c as L,s as ts,v as P,a9 as ns,aa as ds,ab as is,r as i,ac as cs,t as h,ad as ls,j as s,ae as os,af as ms}from"./index-ByY07t5U.js";import{u as hs,z as c,t as xs}from"./index-pvnq_pFp.js";import{D as V}from"./DashboardLayout-CorAQK4x.js";import{C,a as S,c as E,b as z,e as B}from"./card-DrHBsbjm.js";import{B as u}from"./button-DBciqQcI.js";import{I as N}from"./input-DcxO3ESS.js";import{L as n}from"./label-CtRxIZG0.js";import{T as us,a as ps,b as A,c as H}from"./tabs-jpblMaOk.js";import{B as k}from"./badge-B45milNp.js";import{S as gs}from"./separator-hKRhLBlN.js";import{U as js}from"./user-DOTUANSB.js";import{U as Ns,C as ws}from"./user-check-B-SYn2ow.js";import{M as W}from"./mail-BLb2j5Tk.js";import{P as K}from"./phone-DhirDCGg.js";import{C as ys}from"./circle-check-big-BqL8GB_a.js";import{C as fs}from"./calendar-DaBMcz2l.js";import{L as R}from"./loader-circle-CHQfb1Hg.js";import{E as U}from"./eye-off-CkD6P0Zk.js";import{E as F}from"./eye-VMx-kwYO.js";import"./index-n1Mj4gwV.js";import"./index-Dxwkp90n.js";import"./index-DjrpyVfh.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=L("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=L("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=L("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),vs=c.object({oldPassword:c.string().min(6,"Password must be at least 6 characters"),newPassword:c.string().min(6,"Password must be at least 6 characters"),confirmPassword:c.string().min(6,"Password must be at least 6 characters")}).refine(t=>t.newPassword===t.confirmPassword,{message:"New password and confirm password must match",path:["confirmPassword"]}).refine(t=>t.oldPassword!==t.newPassword,{message:"New password must be different from old password",path:["newPassword"]}),Ps=c.object({phone:c.string().min(10,"Phone number must be 10 digits").max(10,"Phone number must be 10 digits").regex(/^\d{10}$/,"Phone number must contain only digits")}),O=()=>s.jsx("div",{className:"space-y-6",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:Array.from({length:6}).map((t,e)=>s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded w-20 animate-pulse"}),s.jsx("div",{className:"h-10 bg-gray-100 rounded-md w-full animate-pulse"})]},e))})});function Xs(){var T;const t=ts(),e=P(ns),D=P(ds),p=P(is),[d,w]=i.useState(""),[g,j]=i.useState(""),[y,I]=i.useState(!1),[l,X]=i.useState({old:!1,new:!1,confirm:!1}),{register:f,handleSubmit:Y,formState:{errors:o,isSubmitting:x},reset:Z,watch:_}=hs({resolver:xs(vs)}),b=_();i.useEffect(()=>{if(e!=null&&e.phoneNumber){const a=e.phoneNumber.startsWith("+91")?e.phoneNumber.substring(3):e.phoneNumber;w(a)}},[e]),i.useEffect(()=>{e||t(cs()).catch(a=>{console.error("Failed to fetch profile:",a)})},[t,e]),i.useEffect(()=>{p&&(h({title:"Error",description:typeof p=="string"?p:"An unexpected error occurred",variant:"destructive"}),t(ls()))},[p,t]);const G=a=>{var r;j("");try{return Ps.parse({phone:a}),!0}catch(m){return m instanceof c.ZodError?j(((r=m.errors[0])==null?void 0:r.message)||"Invalid phone number"):j("Invalid phone number"),!1}},J=async a=>{try{await t(os({oldPassword:a.oldPassword,newPassword:a.newPassword})).unwrap(),h({title:"Success",description:"Password updated successfully"}),Z()}catch(r){const m=r instanceof Error?r.message:"Failed to update password";h({title:"Error",description:m,variant:"destructive"})}},Q=async()=>{if(!G(d))return;const a=`+91${d}`;if(a===(e==null?void 0:e.phoneNumber)){h({title:"No Changes",description:"Phone number is the same as current number",variant:"default"});return}I(!0);try{await t(ms(a)).unwrap(),h({title:"Success",description:"Phone number updated successfully"})}catch(r){const m=r instanceof Error?r.message:"Failed to update phone number";if(h({title:"Error",description:m,variant:"destructive"}),e!=null&&e.phoneNumber){const rs=e.phoneNumber.startsWith("+91")?e.phoneNumber.substring(3):e.phoneNumber;w(rs)}}finally{I(!1)}},v=a=>{X(r=>({...r,[a]:!r[a]}))},ss=a=>{if(!a)return"-";try{return new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"-"}},es=a=>{const r=a.target.value.replace(/\D/g,"");r.length<=10&&(w(r),j(""))},M=d!==(((T=e==null?void 0:e.phoneNumber)==null?void 0:T.substring(3))||""),as=b.oldPassword||b.newPassword||b.confirmPassword;return D&&!e?s.jsx(V,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("div",{className:"h-8 bg-gray-200 rounded w-32 animate-pulse"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-64 animate-pulse"})]}),s.jsx("div",{className:"h-10 bg-gray-100 rounded animate-pulse"}),s.jsxs(C,{children:[s.jsxs(S,{children:[s.jsx("div",{className:"h-6 bg-gray-200 rounded w-40 animate-pulse"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-48 animate-pulse"})]}),s.jsx(E,{children:s.jsx(O,{})})]})]})}):s.jsx(V,{children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Settings"}),s.jsx("p",{className:"text-sm text-gray-500",children:"Manage your account settings and preferences"})]}),s.jsxs(us,{defaultValue:"profile",className:"space-y-6",children:[s.jsxs(ps,{className:"grid w-full max-w-md grid-cols-2",children:[s.jsxs(A,{value:"profile",className:"flex items-center gap-2",children:[s.jsx(js,{className:"h-4 w-4"}),"Profile"]}),s.jsxs(A,{value:"security",className:"flex items-center gap-2",children:[s.jsx(q,{className:"h-4 w-4"}),"Security"]})]}),s.jsx(H,{value:"profile",children:s.jsxs(C,{children:[s.jsxs(S,{children:[s.jsx(z,{children:"Profile Information"}),s.jsx(B,{children:"Your personal details and account information"})]}),s.jsx(E,{children:D?s.jsx(O,{}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(n,{className:"text-sm font-medium flex items-center gap-2",children:[s.jsx(bs,{className:"h-4 w-4 text-gray-400"}),"User ID"]}),s.jsx("div",{className:"p-3 bg-gray-50 border rounded-md",children:s.jsx("code",{className:"text-sm text-gray-700 break-all",children:(e==null?void 0:e.uid)||"-"})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(n,{className:"text-sm font-medium flex items-center gap-2",children:[s.jsx(Ns,{className:"h-4 w-4 text-gray-400"}),"Full Name"]}),s.jsx("div",{className:"p-3 bg-gray-50 border rounded-md",children:s.jsx("p",{className:"text-sm text-gray-700",children:(e==null?void 0:e.displayName)||"Not set"})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(n,{className:"text-sm font-medium flex items-center gap-2",children:[s.jsx(W,{className:"h-4 w-4 text-gray-400"}),"Email Address"]}),s.jsx("div",{className:"p-3 bg-gray-50 border rounded-md",children:s.jsx("p",{className:"text-sm text-gray-700",children:(e==null?void 0:e.email)||"Not set"})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(n,{className:"text-sm font-medium flex items-center gap-2",children:[s.jsx(K,{className:"h-4 w-4 text-gray-400"}),"Phone Number"]}),s.jsx("div",{className:"p-3 bg-gray-50 border rounded-md",children:s.jsx("p",{className:"text-sm text-gray-700",children:(e==null?void 0:e.phoneNumber)||"Not set"})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(n,{className:"text-sm font-medium flex items-center gap-2",children:[s.jsx(q,{className:"h-4 w-4 text-gray-400"}),"Role"]}),s.jsx("div",{className:"p-3 bg-gray-50 border rounded-md",children:s.jsx(k,{variant:"secondary",children:(e==null?void 0:e.role)||"User"})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(n,{className:"text-sm font-medium flex items-center gap-2",children:[s.jsx(W,{className:"h-4 w-4 text-gray-400"}),"Email Status"]}),s.jsx("div",{className:"p-3 bg-gray-50 border rounded-md",children:s.jsx("div",{className:"flex items-center gap-2",children:e!=null&&e.emailVerified?s.jsxs(s.Fragment,{children:[s.jsx(ys,{className:"h-4 w-4 text-green-500"}),s.jsx(k,{variant:"outline",className:"text-green-700 border-green-200",children:"Verified"})]}):s.jsxs(s.Fragment,{children:[s.jsx(ws,{className:"h-4 w-4 text-red-500"}),s.jsx(k,{variant:"outline",className:"text-red-700 border-red-200",children:"Not Verified"})]})})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(n,{className:"text-sm font-medium flex items-center gap-2",children:[s.jsx(fs,{className:"h-4 w-4 text-gray-400"}),"Last Login"]}),s.jsx("div",{className:"p-3 bg-gray-50 border rounded-md",children:s.jsx("p",{className:"text-sm text-gray-700",children:ss(e==null?void 0:e.lastSignInTime)})})]})]})})]})}),s.jsx(H,{value:"security",children:s.jsxs(C,{children:[s.jsxs(S,{children:[s.jsx(z,{children:"Security Settings"}),s.jsx(B,{children:"Manage your phone number and password"})]}),s.jsx(E,{children:s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(K,{className:"h-4 w-4 text-gray-400"}),s.jsx("h3",{className:"text-lg font-medium",children:"Phone Number"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("div",{children:s.jsxs(n,{className:"text-sm text-gray-500",children:["Current: ",(e==null?void 0:e.phoneNumber)||"Not set"]})}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsxs("div",{className:"relative w-40",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx("span",{className:"text-gray-500 text-sm",children:"+91"})}),s.jsx(N,{type:"tel",value:d,onChange:es,disabled:y,className:"pl-12",placeholder:"Enter phone number",maxLength:10})]}),s.jsx(u,{type:"button",onClick:Q,disabled:y||!M||d.length!==10||!!g,className:"shrink-0",children:y?s.jsxs(s.Fragment,{children:[s.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating..."]}):"Update"})]}),g&&s.jsx("p",{className:"text-sm text-red-500",children:g}),M&&!g&&d.length===10&&s.jsxs("div",{className:"text-xs text-gray-500 p-3 bg-blue-50 border border-blue-200 rounded-md",children:["Phone number will be updated to:"," ",s.jsxs("strong",{children:["+91",d]})]})]})]}),s.jsx(gs,{}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx($,{className:"h-4 w-4 text-gray-400"}),s.jsx("h3",{className:"text-lg font-medium",children:"Change Password"})]}),s.jsxs("form",{onSubmit:Y(J),className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(n,{htmlFor:"oldPassword",children:"Current Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(N,{id:"oldPassword",type:l.old?"text":"password",...f("oldPassword"),disabled:x,placeholder:"Enter current password"}),s.jsx(u,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>v("old"),children:l.old?s.jsx(U,{className:"h-4 w-4 text-gray-400"}):s.jsx(F,{className:"h-4 w-4 text-gray-400"})})]}),o.oldPassword&&s.jsx("p",{className:"text-sm text-red-500",children:o.oldPassword.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(n,{htmlFor:"newPassword",children:"New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(N,{id:"newPassword",type:l.new?"text":"password",...f("newPassword"),disabled:x,placeholder:"Enter new password"}),s.jsx(u,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>v("new"),children:l.new?s.jsx(U,{className:"h-4 w-4 text-gray-400"}):s.jsx(F,{className:"h-4 w-4 text-gray-400"})})]}),o.newPassword&&s.jsx("p",{className:"text-sm text-red-500",children:o.newPassword.message})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(n,{htmlFor:"confirmPassword",children:"Confirm New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(N,{id:"confirmPassword",type:l.confirm?"text":"password",...f("confirmPassword"),disabled:x,placeholder:"Confirm new password"}),s.jsx(u,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>v("confirm"),children:l.confirm?s.jsx(U,{className:"h-4 w-4 text-gray-408"}):s.jsx(F,{className:"h-4 w-4 text-gray-400"})})]}),o.confirmPassword&&s.jsx("p",{className:"text-sm text-red-500",children:o.confirmPassword.message})]}),s.jsx(u,{type:"submit",disabled:x||!as,className:"w-full sm:w-auto",children:x?s.jsxs(s.Fragment,{children:[s.jsx(R,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating Password..."]}):s.jsxs(s.Fragment,{children:[s.jsx($,{className:"mr-2 h-4 w-4"}),"Update Password"]})})]})]})]})})]})})]})]})})}export{Xs as default};
