import{c as C,j as e,X as M,L as Z,a as F,R as X,l as D,J as S,b as G,A as Q,r as v,h as Y,a4 as K,a5 as R}from"./index-ByY07t5U.js";import{T as ee,D as se}from"./DashboardLayout-CorAQK4x.js";import{a as ae,u as te}from"./index-DtW1NRNC.js";import{C as V,a as I,c as E,b as re}from"./card-DrHBsbjm.js";import{B as b}from"./button-DBciqQcI.js";import{S as _,a as L,b as q,c as U,d as w}from"./select-DSUhFaX8.js";import{S as z}from"./search-d2cfHkwq.js";import{F as ie}from"./filter-BcVLYW8s.js";import{B as le}from"./badge-B45milNp.js";import{D as H,a as W,b as J,c as O,e as oe,T,d as ne}from"./dialog-DND4cV_M.js";import{I as y}from"./input-DcxO3ESS.js";import{z as g,u as ce,t as de}from"./index-pvnq_pFp.js";import{S as me}from"./switch-C1bv9KX7.js";import{L as P}from"./loader-circle-CHQfb1Hg.js";import{S as k}from"./skeleton-D-G3Wgw9.js";import{C as ue}from"./calendar-DaBMcz2l.js";import{P as xe}from"./pencil-DXUm_KnJ.js";import"./index-DjrpyVfh.js";import"./Combination-DHf6tu9R.js";import"./index-Dxwkp90n.js";import"./index-DDlNMbpf.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=C("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=C("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=C("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=C("IndianRupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=C("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=C("TicketPercent",[["path",{d:"M2 9a3 3 0 1 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 1 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"1l48ns"}],["path",{d:"M9 9h.01",key:"1q5me6"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"M15 15h.01",key:"lqbp3k"}]]);function be({filterStatus:a,setFilterStatus:n,sortKey:u,setSortKey:d,sortOrder:o,setSortOrder:l,searchTerm:x,setSearchTerm:t}){const p=()=>o==="asc"?e.jsx(pe,{className:"h-4 w-4"}):e.jsx(he,{className:"h-4 w-4"}),h=s=>{switch(s){case"active":return"text-green-700 bg-green-50 border-green-200";case"inactive":return"text-red-700 bg-red-50 border-red-200";default:return"text-gray-700 bg-gray-50 border-gray-200"}},N=s=>{switch(s){case"code":return"Code";case"expiry":return"Expiry";case"discount":return"Discount";default:return s}},j=()=>{n("all"),d("code"),l("asc"),t("")},f=()=>{t("")},i=a!=="all"||u!=="code"||o!=="asc"||x.trim()!=="";return e.jsxs("div",{className:"bg-white border-b border-border/40 px-6 py-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-lg bg-gradient-to-br from-violet-500 to-purple-600 shadow-sm",children:e.jsx(ee,{className:"h-4 w-4 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold tracking-tight text-foreground",children:"Coupons"})]}),e.jsx("br",{}),e.jsx("p",{className:"text-muted-foreground",children:"Manage discount coupons for your customers"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"search",value:x,onChange:s=>t(s.target.value),placeholder:"Search coupons...",className:"pl-9 pr-8 py-1.5 w-full sm:w-64 rounded-md border border-violet-300 bg-violet-50 text-violet-800 text-sm font-medium focus:outline-none focus:ring-2 focus:ring-violet-400 focus:border-violet-500 transition-colors duration-200","aria-label":"Search coupons"}),e.jsx(z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-violet-400 pointer-events-none"}),x&&e.jsx("button",{onClick:f,className:"absolute right-2 top-1/2 -translate-y-1/2 h-5 w-5 rounded-full bg-violet-200 hover:bg-violet-300 flex items-center justify-center transition-colors duration-200","aria-label":"Clear search",children:e.jsx(M,{className:"h-3 w-3 text-violet-600"})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs(_,{value:a,onValueChange:s=>n(s),children:[e.jsx(L,{className:"w-[140px] h-9",children:e.jsx(q,{placeholder:"Filter by status"})}),e.jsxs(U,{children:[e.jsx(w,{value:"all",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-400"}),"All Coupons"]})}),e.jsx(w,{value:"active",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-400"}),"Active"]})}),e.jsx(w,{value:"inactive",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-red-400"}),"Inactive"]})})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_,{value:u,onValueChange:s=>d(s),children:[e.jsx(L,{className:"w-[150px] h-9",children:e.jsx(q,{placeholder:"Sort by"})}),e.jsxs(U,{children:[e.jsx(w,{value:"code",children:"Coupon Code"}),e.jsx(w,{value:"expiry",children:"Expiry Date"}),e.jsx(w,{value:"discount",children:"Discount %"})]})]}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>l(o==="asc"?"desc":"asc"),className:"h-9 w-9 p-0","aria-label":`Sort ${o==="asc"?"descending":"ascending"}`,children:p()})]})]}),e.jsx(b,{asChild:!0,className:"h-9 bg-primary hover:bg-primary/90",children:e.jsxs(Z,{to:"/config/coupons/create",className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Add New Coupon"}),e.jsx("span",{className:"sm:hidden",children:"Add"})]})})]})]}),i&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-4 pt-4 border-t border-border/40",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Active filters:"}),x.trim()!==""&&e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs font-medium border bg-blue-50 text-blue-700 border-blue-200",children:[e.jsx(z,{className:"h-3 w-3"}),'"',x,'"',e.jsx("button",{onClick:f,className:"ml-1 hover:opacity-70 transition-opacity","aria-label":"Clear search filter",children:e.jsx(M,{className:"h-3 w-3"})})]}),a!=="all"&&e.jsxs("div",{className:F("inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs font-medium border",h(a)),children:[e.jsx("div",{className:F("h-2 w-2 rounded-full",a==="active"?"bg-green-400":"bg-red-400")}),a==="active"?"Active":"Inactive",e.jsx("button",{onClick:()=>n("all"),className:"ml-1 hover:opacity-70 transition-opacity","aria-label":"Clear status filter",children:e.jsx(M,{className:"h-3 w-3"})})]}),(u!=="code"||o!=="asc")&&e.jsxs("div",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-md text-xs font-medium border bg-blue-50 text-blue-700 border-blue-200",children:[p(),N(u),e.jsx("button",{onClick:()=>{d("code"),l("asc")},className:"ml-1 hover:opacity-70 transition-opacity","aria-label":"Clear sort filter",children:e.jsx(M,{className:"h-3 w-3"})})]}),e.jsx(b,{variant:"ghost",size:"sm",onClick:j,className:"h-6 px-2 text-xs text-muted-foreground hover:text-foreground transition-colors",children:"Clear all"})]})]})}const je=g.object({couponName:g.string().min(2,"Coupon name must be at least 2 characters").max(50,"Coupon name must be less than 50 characters"),couponCode:g.string().min(2,"Coupon code must be at least 2 characters").max(20,"Coupon code must be less than 20 characters").regex(/^[A-Z0-9_-]+$/,"Coupon code can only contain uppercase letters, numbers, hyphens, and underscores"),maxDiscount:g.coerce.number({required_error:"Max discount is required",invalid_type_error:"Max discount must be a valid number"}).positive("Max discount must be greater than 0").max(1e4,"Max discount cannot exceed 10,000"),minValue:g.coerce.number({required_error:"Minimum order value is required",invalid_type_error:"Minimum order value must be a valid number"}).positive("Minimum order value must be greater than 0").max(1e5,"Minimum order value cannot exceed 100,000"),discountPercentage:g.coerce.number({required_error:"Discount percentage is required",invalid_type_error:"Discount percentage must be a valid number"}).min(1,"Discount percentage must be at least 1%").max(100,"Discount percentage cannot exceed 100%"),validFrom:g.string().min(1,"Valid from date is required"),validTill:g.string().min(1,"Valid till date is required"),isActive:g.boolean()}).refine(a=>{const n=new Date(a.validFrom),u=new Date(a.validTill);return n<u},{message:"Valid till date must be after valid from date",path:["validTill"]}).refine(a=>{const n=a.minValue*a.discountPercentage/100;return a.maxDiscount>=n*.1},{message:"Max discount seems too low for the given percentage and minimum order value",path:["maxDiscount"]});function fe({coupon:a,onClose:n,onUpdateSuccess:u}){const[d,o]=X.useState(!1),{register:l,handleSubmit:x,formState:{errors:t},setValue:p,watch:h,trigger:N}=ce({resolver:de(je),mode:"onChange",defaultValues:{couponName:a.couponName,couponCode:a.couponCode,maxDiscount:a.maxDiscount,minValue:a.minValue,discountPercentage:a.discountPercentage,validFrom:D(new Date(a.validFrom._seconds*1e3),"yyyy-MM-dd"),validTill:D(new Date(a.validTill._seconds*1e3),"yyyy-MM-dd"),isActive:a.isActive}}),j=h("isActive"),f=async s=>{var r,m;console.log("Submitting coupon data:",s),o(!0);try{const c=new Date(s.validFrom),A=new Date(s.validTill);if(c>=A){S.error("Valid till date must be after valid from date"),o(!1);return}await G.put(Q.UPDATE_COUPON(),s,{params:{couponId:a.id}}),S.success("Coupon updated successfully"),u(),n()}catch(c){console.error("Error updating coupon:",c);const A=((m=(r=c==null?void 0:c.response)==null?void 0:r.data)==null?void 0:m.message)||"Failed to update coupon";S.error(A)}finally{o(!1)}},i=s=>r=>{const m=r.target.value;p(s,m),setTimeout(()=>N(s),0)};return e.jsx(H,{open:!0,onOpenChange:n,children:e.jsxs(W,{className:"max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs(J,{children:[e.jsx(O,{children:"Edit Coupon"}),e.jsx(oe,{children:"Update your coupon details below."})]}),e.jsxs("form",{onSubmit:x(f),className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Coupon Name"}),e.jsx(y,{...l("couponName"),placeholder:"Enter coupon name"}),t.couponName&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.couponName.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Coupon Code"}),e.jsx(y,{...l("couponCode"),placeholder:"e.g., SAVE20",style:{textTransform:"uppercase"}}),t.couponCode&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.couponCode.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Max Discount (₹)"}),e.jsx(y,{type:"number",step:"0.01",min:"0",...l("maxDiscount"),onChange:i("maxDiscount"),placeholder:"Maximum discount amount"}),t.maxDiscount&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.maxDiscount.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Discount Percentage (%)"}),e.jsx(y,{type:"number",step:"0.01",min:"1",max:"100",...l("discountPercentage"),onChange:i("discountPercentage"),placeholder:"1-100"}),t.discountPercentage&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.discountPercentage.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Minimum Order Value (₹)"}),e.jsx(y,{type:"number",step:"0.01",min:"0",...l("minValue"),onChange:i("minValue"),placeholder:"Minimum order amount"}),t.minValue&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.minValue.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Valid From"}),e.jsx(y,{type:"date",...l("validFrom"),min:D(new Date,"yyyy-MM-dd")}),t.validFrom&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.validFrom.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Valid Till"}),e.jsx(y,{type:"date",...l("validTill"),min:h("validFrom")||D(new Date,"yyyy-MM-dd")}),t.validTill&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:t.validTill.message})]}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("label",{htmlFor:"isActive",className:"text-sm font-medium",children:"Active Status"}),e.jsx(me,{id:"isActive",checked:j,onCheckedChange:s=>p("isActive",s)})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(b,{variant:"outline",type:"button",onClick:n,disabled:d,children:"Cancel"}),e.jsx(b,{type:"submit",disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating..."]}):"Update Coupon"})]})]})]})})}function Ne({coupons:a,loading:n}){const[u,d]=v.useState(null),[o,l]=v.useState(null),[x,t]=v.useState(null),p=Y(),h=s=>new Date(s._seconds*1e3),N=async s=>{l(s);try{p(K(s))}catch{l(null)}},j=async()=>{await p(R())},f=s=>{const r=h(s),m=new Date,c=Math.ceil((r.getTime()-m.getTime())/(1e3*60*60*24));return c<=7&&c>0},i=s=>h(s)<new Date;return n?e.jsx("div",{className:"grid gap-8 p-6 sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4",children:[...Array(8)].map((s,r)=>e.jsxs(V,{className:"relative h-[22rem] border border-violet-200 bg-white/90 backdrop-blur-sm shadow-md",children:[e.jsxs(I,{className:"p-6 pb-4",children:[e.jsx(k,{className:"h-6 w-32"}),e.jsx(k,{className:"h-4 w-24"})]}),e.jsxs(E,{className:"p-6 space-y-4",children:[e.jsx(k,{className:"h-16 w-full"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(k,{className:"h-14"}),e.jsx(k,{className:"h-14"})]})]})]},r))}):!a||a.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-violet-400/20 to-fuchsia-400/20 rounded-full blur-xl"}),e.jsx("div",{className:"relative bg-gradient-to-br from-violet-500 to-fuchsia-600 p-6 rounded-2xl shadow-2xl",children:e.jsx(B,{className:"h-12 w-12 text-white"})})]}),e.jsx("h3",{className:"text-xl font-semibold text-gray-700 mt-6 mb-2",children:"No coupons available"}),e.jsx("p",{className:"text-gray-500 text-center max-w-md",children:"Create your first coupon to start offering discounts to your customers."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid gap-8 p-6 sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4",children:a.map(s=>{const r=i(s.validTill),m=f(s.validTill);return e.jsxs("div",{className:"group relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-violet-50 via-purple-50 to-fuchsia-50 rounded-2xl transition-all duration-300 group-hover:from-violet-100 group-hover:via-purple-100 group-hover:to-fuchsia-100"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-violet-200/50 via-purple-200/50 to-fuchsia-200/50 rounded-2xl blur-sm opacity-0 group-hover:opacity-100 transition-all duration-300"}),e.jsxs(V,{className:"relative h-full border border-violet-200 bg-white/90 backdrop-blur-sm shadow-md transition-all duration-300 group-hover:shadow-xl group-hover:scale-[1.02] flex flex-col",children:[e.jsx("div",{className:"absolute -top-4 -right-4 z-10",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-violet-400 to-fuchsia-500 rounded-full blur-md opacity-60"}),e.jsx("div",{className:"relative bg-gradient-to-br from-violet-500 to-fuchsia-600 p-3 rounded-full shadow-lg transform transition-transform duration-300 group-hover:rotate-12 group-hover:scale-110",children:e.jsx(B,{className:"h-6 w-6 text-white"})})]})}),(r||m)&&e.jsx("div",{className:"absolute top-3 left-3 z-10",children:e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${r?"bg-red-100 text-red-700":"bg-amber-100 text-amber-700"}`,children:r?"⚠️ Expired":"⏰ Expiring Soon"})}),e.jsx(I,{className:"p-6 pb-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(re,{className:"text-2xl font-bold bg-gradient-to-r from-violet-700 to-purple-500 bg-clip-text text-transparent pr-16",children:s.couponCode}),e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:s.couponName}),e.jsxs(le,{variant:s.isActive&&!r?"secondary":"destructive",className:`w-fit font-medium ${s.isActive&&!r?"bg-violet-100 text-violet-700 hover:bg-violet-200 border-violet-200":"bg-red-100 text-red-700 hover:bg-red-200 border-red-200"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full mr-2 ${s.isActive&&!r?"bg-violet-500":"bg-red-500"}`}),s.isActive&&!r?"Active":r?"Expired":"Inactive"]})]})}),e.jsxs(E,{className:"p-6 pt-2 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-violet-500 to-purple-600 p-4 rounded-xl shadow-lg",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent"}),e.jsxs("div",{className:"relative",children:[e.jsx("p",{className:"text-xs text-violet-100 font-medium uppercase tracking-wider",children:"Discount %"}),e.jsx("p",{className:"text-xl font-bold text-white mt-1",children:s.discountPercentage?`${s.discountPercentage}%`:"N/A"})]}),e.jsx(ve,{className:"absolute bottom-2 right-2 h-6 w-6 text-white/60"})]}),e.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-fuchsia-500 to-pink-500 p-4 rounded-xl shadow-lg",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent"}),e.jsxs("div",{className:"relative",children:[e.jsx("p",{className:"text-xs text-pink-100 font-medium uppercase tracking-wider",children:"Max Discount"}),e.jsx("p",{className:"text-xl font-bold text-white mt-1",children:s.maxDiscount})]}),e.jsx($,{className:"absolute bottom-2 right-2 h-6 w-6 text-white/60"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 p-3 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx($,{className:"h-3 w-3 text-violet-600"}),e.jsx("p",{className:"text-xs text-gray-700 font-medium uppercase tracking-wide",children:"Min Order"})]}),e.jsxs("p",{className:"text-lg font-bold text-gray-800",children:["₹",s.minValue.toLocaleString()]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 p-3 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ue,{className:"h-3 w-3 text-gray-600"}),e.jsx("p",{className:"text-xs text-gray-700 font-medium uppercase tracking-wide",children:"Valid Until"})]}),e.jsx("p",{className:"text-xs font-bold text-gray-800 leading-tight",children:D(h(s.validTill),"MMM dd, yyyy")})]})]})]}),e.jsx("div",{className:"mt-auto p-6 pt-4 pb-6 bg-gradient-to-t from-white/90 via-white/50 to-transparent",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(b,{disabled:s.id===o,size:"sm",variant:"outline",className:"flex-1 bg-white/80 backdrop-blur-sm border-violet-200 text-violet-700 hover:bg-violet-50 hover:border-violet-300",onClick:()=>d(s),children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(b,{size:"sm",variant:"outline",className:"flex-1 bg-white/80 backdrop-blur-sm border-fuchsia-200 text-fuchsia-700 hover:bg-fuchsia-50 hover:border-fuchsia-300",onClick:()=>t(s.id),disabled:o===s.id,children:[o===s.id?e.jsx(P,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(T,{className:"h-4 w-4 mr-2"}),"Delete"]})]})})]})]},s.id)})}),u&&e.jsx(fe,{coupon:u,onClose:()=>d(null),onUpdateSuccess:j}),e.jsx(H,{open:!!x,onOpenChange:()=>t(null),children:e.jsxs(W,{className:"sm:max-w-md",children:[e.jsx(J,{children:e.jsxs(O,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5 text-red-500"}),"Confirm Deletion"]})}),e.jsx("div",{className:"py-4",children:e.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Are you sure you want to delete this coupon? This action cannot be undone."})}),e.jsxs(ne,{className:"gap-2",children:[e.jsx(b,{variant:"ghost",onClick:()=>t(null),children:"Cancel"}),e.jsxs(b,{variant:"destructive",onClick:()=>{x&&(N(x),t(null))},disabled:!!o,className:"bg-red-600 hover:bg-red-700",children:[o?e.jsx(P,{className:"animate-spin mr-2 h-4 w-4"}):e.jsx(T,{className:"mr-2 h-4 w-4"}),"Delete Coupon"]})]})]})})]})}function ye(){const a=ae(),{coupons:n,loading:u}=te(i=>i.coupons),[d,o]=v.useState("all"),[l,x]=v.useState("code"),[t,p]=v.useState("asc"),[h,N]=v.useState("");v.useEffect(()=>{a(R())},[a]);const j=i=>new Date(i._seconds*1e3),f=v.useMemo(()=>{let i=n;if(d!=="all"){const s=d==="active";i=i.filter(r=>r.isActive===s)}if(h.trim()){const s=h.toLowerCase();i=i.filter(r=>r.couponCode.toLowerCase().includes(s)||r.couponName.toLowerCase().includes(s))}return i=i.slice().sort((s,r)=>{let m,c;switch(l){case"code":m=s.couponCode.toLowerCase(),c=r.couponCode.toLowerCase();break;case"expiry":m=j(s.validTill).getTime(),c=j(r.validTill).getTime();break;case"discount":m=s.discountPercentage||0,c=r.discountPercentage||0;break;default:m=s.couponCode.toLowerCase(),c=r.couponCode.toLowerCase()}return m<c?t==="asc"?-1:1:m>c?t==="asc"?1:-1:0}),i},[n,d,h,l,t]);return e.jsxs("div",{className:"space-y-4",children:[e.jsx(be,{filterStatus:d,setFilterStatus:o,sortKey:l,setSortKey:x,sortOrder:t,setSortOrder:p,searchTerm:h,setSearchTerm:N}),e.jsx(V,{children:e.jsx(Ne,{coupons:f,loading:u})})]})}function He(){return e.jsx(se,{children:e.jsx(ye,{})})}export{He as default};
