import{r as d,q as S,b as w,A as y,j as e,X as A,L as B,u as D}from"./index-ByY07t5U.js";import{D as k}from"./DashboardLayout-CorAQK4x.js";import{B as g}from"./button-DBciqQcI.js";import{S as E}from"./switch-C1bv9KX7.js";import{D as I,a as T,b as L,c as F,d as U,T as _}from"./dialog-DND4cV_M.js";import{S as z}from"./square-pen-BFr-I4KV.js";import{I as P}from"./input-DcxO3ESS.js";import{S as $}from"./search-d2cfHkwq.js";import"./index-DDlNMbpf.js";import"./index-Dxwkp90n.js";import"./Combination-DHf6tu9R.js";const H=()=>{const[l,i]=d.useState([]),[c,u]=d.useState(""),[p,f]=d.useState(!0),{toast:n}=S(),m=async()=>{try{const a=await w.get(`${y.GET_ALL_BANNERS()}`);if(a.status!==200||!a.data.success)throw new Error(a.data.message||"Failed to fetch banners");const r=a.data.data.map(t=>({id:t.bannerId,title:t.title,description:t.description,imageUrl:t.imageUrl,isActive:t.enable??t.isActive??!1,createdAt:new Date(t.createdAt._seconds*1e3+t.createdAt._nanoseconds/1e6),isDeleted:t.isDeleted})).filter(t=>!t.isDeleted);i(r)}catch(a){n({title:"Error",description:a instanceof Error?a.message:"Failed to load banners",variant:"destructive"})}finally{f(!1)}};d.useEffect(()=>{m()},[]);const o=async a=>{try{const r=await w.delete(`${y.DELETE_BANNER()}/${a}`,{params:{bannerId:a}});if(r.data.success)i(t=>t.filter(j=>j.id!==a)),n({title:"Banner deleted",description:r.data.message||"The banner has been deleted."});else throw new Error(r.data.message||"Failed to delete banner")}catch(r){n({title:"Error",description:r instanceof Error?r.message:"Failed to delete banner",variant:"destructive"})}},x=async a=>{try{await w.patch(`${y.TOGGLE_BANNER_STATUS()}/changeStatusAppBanner`,null,{params:{bannerId:a}}),i(r=>r.map(t=>t.id===a?{...t,isActive:!t.isActive}:t)),n({title:"Success",description:"Banner status updated."})}catch{n({title:"Error",description:"Failed to update status",variant:"destructive"})}},v=l.filter(a=>a.title.toLowerCase().includes(c.toLowerCase())||a.description.toLowerCase().includes(c.toLowerCase()));return{banners:l,setBanners:i,searchQuery:c,setSearchQuery:u,filteredBanners:v,handleDeleteBanner:o,handleToggleStatus:x,isLoading:p}};function Q({banners:l,onEdit:i,onDelete:c,onToggle:u,isLoading:p}){const[f,n]=d.useState(null),[m,o]=d.useState({open:!1,bannerId:null}),[x,v]=d.useState(!1),[a,r]=d.useState(null),t=async s=>{n(s),await u(s),n(null)},j=(s,h,C)=>{s.stopPropagation(),r({imageUrl:h,title:C})},N=async()=>{if(m.bannerId){v(!0);try{await c(m.bannerId),o({open:!1,bannerId:null})}catch(s){console.error("Error deleting banner:",s)}finally{v(!1)}}},b=s=>new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(s);return e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsx(I,{open:m.open,onOpenChange:()=>!x&&o({open:!1,bannerId:null}),children:e.jsxs(T,{className:"sm:max-w-md",children:[e.jsxs(L,{children:[e.jsx(F,{children:"Confirm Delete"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Are you sure you want to delete this banner? This action cannot be undone."})]}),e.jsxs(U,{className:"flex justify-end gap-2",children:[e.jsx(g,{variant:"outline",onClick:()=>o({open:!1,bannerId:null}),disabled:x,children:"Cancel"}),e.jsx(g,{variant:"destructive",onClick:N,disabled:x,children:x?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Deleting..."]}):"Delete"})]})]})}),a&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80",onClick:()=>r(null),children:e.jsxs("div",{className:"relative max-w-[90vw] max-h-[90vh]",children:[e.jsx(g,{variant:"ghost",size:"icon",onClick:()=>r(null),className:"absolute -top-12 -right-2 h-8 w-8 bg-white/90 hover:bg-white text-black hover:text-red-500 transition-colors rounded-full shadow-lg z-10",children:e.jsx(A,{className:"h-5 w-5"})}),e.jsx("div",{className:"max-h-[80vh] max-w-[80vw] flex items-center justify-center",children:e.jsx("img",{src:a.imageUrl,alt:a.title,className:"max-h-[70vh] max-w-[70vw] object-contain rounded-lg shadow-2xl",onClick:s=>s.stopPropagation(),style:{maxHeight:"70vh",maxWidth:"70vw",width:"auto",height:"auto"}})})]})}),p?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(3)].map((s,h)=>e.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"h-48 bg-gray-200 rounded-t-lg animate-pulse"}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"h-6 w-3/4 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-5 w-16 bg-gray-200 rounded-full animate-pulse"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 w-full bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-4 w-5/6 bg-gray-200 rounded animate-pulse"})]}),e.jsx("div",{className:"h-4 w-1/3 bg-gray-200 rounded animate-pulse"}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"h-6 w-12 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-4 w-16 bg-gray-200 rounded animate-pulse"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded animate-pulse"})]})]})]})]},h))}):l.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"bg-gray-50 rounded-lg p-8",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No banners found"}),e.jsx("p",{className:"text-gray-500",children:"Create your first banner to get started."})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(s=>e.jsxs("div",{className:"bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden border border-gray-200",children:[e.jsx("div",{className:"relative group h-48",children:s.imageUrl?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:s.imageUrl,alt:s.title,className:"w-full h-full object-cover rounded-t-lg cursor-pointer hover:opacity-90 transition-opacity",onClick:h=>j(h,s.imageUrl,s.title),style:{maxHeight:"192px",objectFit:"cover"}}),e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity rounded-t-lg cursor-pointer",onClick:h=>j(h,s.imageUrl,s.title),children:e.jsx("span",{className:"text-white text-sm font-medium px-3 py-1 bg-black/30 rounded-md",children:"Click to view"})})]}):e.jsx("div",{className:"w-full h-full bg-gray-100 rounded-t-lg flex items-center justify-center",children:e.jsx("span",{className:"text-gray-400 text-sm",children:"No image"})})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 leading-tight",children:s.title}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${s.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.isActive?"Active":"Inactive"})]}),e.jsx("p",{className:"text-gray-600 text-sm line-clamp-3 mb-4",children:s.description}),e.jsxs("div",{className:"text-xs text-gray-500 mb-4",children:["Created on ",b(s.createdAt)]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(E,{checked:s.isActive,onClick:()=>t(s.id),disabled:f===s.id}),e.jsx("span",{className:"text-sm text-gray-600",children:s.isActive?"Active":"Inactive"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>i(s),className:"p-2 hover:bg-blue-50 hover:text-blue-600 transition-colors",children:e.jsx(z,{className:"h-4 w-4"})}),e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>o({open:!0,bannerId:s.id}),className:"p-2 hover:bg-red-50 hover:text-red-600 transition-colors",children:e.jsx(_,{className:"h-4 w-4"})})]})]})]})]},s.id))})]})}function R({searchQuery:l,onSearchChange:i}){return e.jsxs("div",{className:"relative w-full max-w-sm",children:[e.jsx($,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(P,{type:"search",placeholder:"Search banners...",value:l,onChange:c=>i(c.target.value),className:"w-full pl-9 md:max-w-sm"})]})}function G({searchQuery:l,onSearchChange:i}){return e.jsxs("div",{className:"flex flex-col items-start justify-between gap-4  sm:flex-row sm:items-center",children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"App Banners"}),e.jsxs("div",{className:"ml-auto flex w-full flex-col gap-2 sm:w-auto sm:flex-row sm:gap-2",children:[e.jsx(R,{searchQuery:l,onSearchChange:i}),e.jsx(g,{asChild:!0,className:"sm:ml-2",children:e.jsx(B,{to:"/config/app-banner/create",children:"Create Banner"})})]})]})}function se(){const{filteredBanners:l,searchQuery:i,setSearchQuery:c,handleDeleteBanner:u,handleToggleStatus:p,isLoading:f}=H(),n=D(),m=o=>{n(`/config/app-banner/edit/${o.id}`)};return e.jsx(k,{children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx(G,{searchQuery:i,onSearchChange:c}),e.jsx("p",{className:"text-muted-foreground",children:"Welcome to the App Banner Page, where you can create and manage banners."}),e.jsx(Q,{banners:l,onEdit:m,onDelete:u,onToggle:p,isLoading:f})]})})}export{se as default};
