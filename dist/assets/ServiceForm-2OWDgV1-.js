import{R as l,j as e,X as G}from"./index-ByY07t5U.js";import{o as M,s as x,e as N,u as q,t as L}from"./index-pvnq_pFp.js";import{B as f}from"./button-DBciqQcI.js";import{I as W}from"./input-DcxO3ESS.js";import{T as z}from"./textarea-CMzAX9ph.js";import{F as A,a as m,b as d,c as g,d as p,e as j}from"./form-D1pnXXWo.js";import{S as H,a as J,b as K,c as X,d as S}from"./select-DSUhFaX8.js";import{S as $}from"./switch-C1bv9KX7.js";import{F as Q,U as Y}from"./upload-Dz_LuVq4.js";const Z=M({name:x().min(3,{message:"Name must be at least 3 characters"}).max(50,{message:"Name must be less than 50 characters"}),description:x().min(10,{message:"Description must be at least 10 characters"}).max(500,{message:"Description must be less than 500 characters"}),pricingmodel:N(["per_kg","per_item"],{message:"Pricing model is required"}),status:N(["active","inactive"]),imageBase64:x().min(1,{message:"Image is required"})}),ce=({service:t,isLoading:u=!1,fileInputKey:w,handleInputChange:o,handleStatusChange:D,handlePricingModelChange:B,handleFileChange:C,handleRemoveThumbnail:F,handleSubmit:k,handleCancel:I})=>{const[E,h]=l.useState(!1),[P,V]=l.useState(!1),[i,T]=l.useState(null),r=q({resolver:L(Z),defaultValues:{name:t.name||"",description:t.description||"",pricingmodel:t.pricingmodel||"per_kg",status:t.status||"active",imageBase64:t.imageBase64||""},mode:"onChange",reValidateMode:"onChange"});l.useEffect(()=>{if(t&&!i){const a={name:t.name||"",description:t.description||"",pricingmodel:t.pricingmodel||"per_kg",status:t.status||"active",imageBase64:t.imageBase64||""};T(a)}},[t,i]),l.useEffect(()=>{if(i){const a=r.getValues(),s=a.name!==i.name||a.description!==i.description||a.pricingmodel!==i.pricingmodel||a.status!==i.status||a.imageBase64!==i.imageBase64;V(s)}},[r.watch(),i]),l.useEffect(()=>{t&&r.reset({name:t.name||"",description:t.description||"",pricingmodel:t.pricingmodel||"per_kg",status:t.status||"active",imageBase64:t.imageBase64||""})},[t,r]);const v=a=>{if(!["image/png","image/jpeg","image/jpg","image/webp"].includes(a.type)){console.error("Invalid file type. Please upload a PNG, JPG, or WebP image file");return}const n=new FileReader;n.onloadend=()=>{const c=n.result;r.setValue("imageBase64",c,{shouldValidate:!0}),o({target:{name:"imageBase64",value:c}})},n.readAsDataURL(a)},_=a=>{a.preventDefault(),h(!0)},U=()=>{h(!1)},O=a=>{if(a.preventDefault(),h(!1),a.dataTransfer.files&&a.dataTransfer.files.length>0){const s=a.dataTransfer.files[0];s.type.startsWith("image/")?v(s):console.error("Invalid file type. Please upload an image file")}},b=()=>{r.setValue("imageBase64","",{shouldValidate:!0}),F()},R=a=>{const s={preventDefault:()=>{}};Object.entries(a).forEach(([n,c])=>{o({target:{name:n,value:c}})}),k(s)},y=r.formState.errors.imageBase64;return e.jsx(A,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(R),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(m,{control:r.control,name:"name",render:({field:a})=>e.jsxs(d,{children:[e.jsx(g,{children:"Service Name"}),e.jsx(p,{children:e.jsx(W,{placeholder:"Enter service name",...a,onChange:s=>{a.onChange(s),o(s)}})}),e.jsx(j,{})]})}),e.jsx(m,{control:r.control,name:"description",render:({field:a})=>e.jsxs(d,{children:[e.jsx(g,{children:"Description"}),e.jsx(p,{children:e.jsx(z,{placeholder:"Enter service description",className:"min-h-[120px]",...a,onChange:s=>{a.onChange(s),o(s)}})}),e.jsx(j,{})]})}),e.jsx(m,{control:r.control,name:"pricingmodel",render:({field:a})=>e.jsxs(d,{children:[e.jsx(g,{children:"Pricing Model"}),e.jsxs(H,{onValueChange:s=>{a.onChange(s),B(s)},defaultValue:a.value,children:[e.jsx(p,{children:e.jsx(J,{children:e.jsx(K,{placeholder:"Select pricing model"})})}),e.jsxs(X,{children:[e.jsx(S,{value:"per_kg",children:"Per KG"}),e.jsx(S,{value:"per_item",children:"Per Item"})]})]}),e.jsx(j,{})]})}),e.jsx(m,{control:r.control,name:"status",render:({field:a})=>e.jsxs(d,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(g,{className:"text-base",children:"Status"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.value==="active"?"Service is active and visible to customers":"Service is inactive and hidden from customers"})]}),e.jsx(p,{children:e.jsx($,{checked:a.value==="active",onCheckedChange:s=>{const n=s?"active":"inactive";a.onChange(n),D(n)}})})]})})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Service Image :"}),e.jsx("div",{className:"text-sm font-medium mb-2",children:"Image Preview"}),e.jsxs("div",{className:"relative aspect-[4/3] overflow-hidden rounded-md border border-gray-200 bg-gray-50",children:[r.watch("imageBase64")?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative h-full w-full",children:[e.jsx("img",{src:r.watch("imageBase64"),alt:"Service preview",className:"h-full w-full object-cover",onError:()=>{b(),console.error("Error loading image")}}),e.jsx("button",{type:"button",className:"absolute top-2 right-2 p-1 rounded-full bg-gray-800/50 hover:bg-gray-800/75 text-white",onClick:a=>{a.stopPropagation(),b()},children:e.jsx(G,{className:"h-4 w-4"})})]})}):e.jsx("div",{className:`flex h-full flex-col items-center justify-center cursor-pointer ${E?"border-primary border-2":"border-dashed border-gray-300"}`,onDragOver:_,onDragLeave:U,onDrop:O,onClick:()=>{var a;return(a=document.getElementById("image-upload"))==null?void 0:a.click()},children:e.jsxs("div",{className:"text-center p-6 flex flex-col items-center gap-2",children:[e.jsx("div",{className:"bg-gray-100 rounded-full p-3",children:e.jsx(Q,{className:"h-6 w-6 text-gray-400"})}),e.jsx("p",{className:"text-sm font-medium",children:"Upload a service image"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Drag and drop or click to browse"}),e.jsxs(f,{type:"button",variant:"outline",size:"sm",className:"mt-2",onClick:a=>{var s;a.stopPropagation(),(s=document.getElementById("image-upload"))==null||s.click()},children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Upload Image"]})]})}),e.jsx("input",{id:"image-upload",type:"file",accept:"image/*",className:"hidden",onChange:a=>{a.target.files&&a.target.files[0]&&(v(a.target.files[0]),C(a))}},w)]}),y&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:y.message})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(f,{type:"button",variant:"outline",onClick:I,disabled:u,children:"Cancel"}),e.jsx(f,{type:"submit",disabled:u||!r.formState.isValid||!P,children:u?"Saving...":"Save Service"})]})]})})};export{ce as S};
