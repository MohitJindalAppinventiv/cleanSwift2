import{c as Ee,j as e,u as ss,q as as,m as De,o as ts,r as o,A as S,b as L}from"./index-ByY07t5U.js";import{P as q,S as rs,D as is}from"./DashboardLayout-CorAQK4x.js";import{D as Me,a as ke,b as Te,c as Le,e as ns,d as cs,T as _e}from"./dialog-DND4cV_M.js";import{z as ce,u as ls,t as os}from"./index-pvnq_pFp.js";import{B as f}from"./button-DBciqQcI.js";import{F as ds,a as ve,b as Ne,c as ye,d as Pe,e as be}from"./form-D1pnXXWo.js";import{I as oe}from"./input-DcxO3ESS.js";import{S as H,a as J,b as K,c as W,d as w}from"./select-DSUhFaX8.js";import{B as ms,T as us}from"./breadcrumb-7WFJLWKT.js";import{A as xs}from"./arrow-left-DJgxny9G.js";import{P as Fe}from"./plus-DsKVMYgt.js";import{C as _,c as F}from"./card-DrHBsbjm.js";import{S as gs}from"./search-d2cfHkwq.js";import{F as hs}from"./filter-BcVLYW8s.js";import{B as X}from"./badge-B45milNp.js";import{D as ps,a as fs,b as js,e as Ce,d as vs}from"./dropdown-menu-BdWAUv_f.js";import{P as Ae}from"./pencil-DXUm_KnJ.js";import{P as Ns,a as ys,b as le,c as Ps,d as bs,e as Cs}from"./pagination-C8Rc9njr.js";import"./index-Dxwkp90n.js";import"./Combination-DHf6tu9R.js";import"./label-CtRxIZG0.js";import"./index-DjrpyVfh.js";import"./index-DDlNMbpf.js";import"./chevron-right-Nhb4I_UE.js";import"./index-n1Mj4gwV.js";import"./chevron-left-BFqG9IJl.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=Ee("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=Ee("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]),Is=ce.object({name:ce.string().min(2,{message:"Name must be at least 2 characters."}),price:ce.coerce.number().min(.01,{message:"Price must be greater than 0."})});function Es({onSubmit:t,onCancel:d,initialData:i={name:"",price:0},isSubmitting:n=!1}){const c=ls({resolver:os(Is),defaultValues:i,mode:"onChange"}),{isDirty:g,isValid:j}=c.formState;return e.jsx(ds,{...c,children:e.jsxs("form",{onSubmit:c.handleSubmit(t),className:"space-y-6",children:[e.jsx(ve,{control:c.control,name:"name",render:({field:r})=>e.jsxs(Ne,{children:[e.jsx(ye,{children:"Product Name"}),e.jsx(Pe,{children:e.jsx(oe,{placeholder:"Enter product name",...r})}),e.jsx(be,{})]})}),e.jsx(ve,{control:c.control,name:"price",render:({field:r})=>e.jsxs(Ne,{children:[e.jsx(ye,{children:"Product Price (Rs.)"}),e.jsx(Pe,{children:e.jsx(oe,{type:"number",step:"0.01",placeholder:"0.00",...r,onChange:x=>{const M=x.target.value;r.onChange(M===""?"":parseFloat(M))}})}),e.jsx(be,{})]})}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(f,{variant:"outline",type:"button",onClick:d,disabled:n,children:"Cancel"}),e.jsx(f,{type:"submit",disabled:!g||!j||n,children:n?"Saving...":"Save Product"})]})]})})}function Se({open:t,onOpenChange:d,onSubmit:i,initialData:n,title:c,isSubmitting:g,services:j=[],categories:r=[],selectedService:x="",setSelectedService:M=()=>{},selectedCategory:V="",setSelectedCategory:I=()=>{},showServiceCategorySelect:z=!1}){const v={name:"",price:0,...n},C=j.find(u=>u.id===x),N=(C==null?void 0:C.pricingModel)==="per_item",A=r.filter(u=>u.serviceName===(C==null?void 0:C.name));return e.jsx(Me,{open:t,onOpenChange:d,children:e.jsxs(ke,{className:"sm:max-w-[425px]",children:[e.jsx(Te,{children:e.jsx(Le,{children:c})}),z&&e.jsxs("div",{className:"space-y-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Select Service"}),e.jsxs(H,{value:x,onValueChange:u=>{M(u),I("")},children:[e.jsx(J,{className:"w-full",children:e.jsx(K,{placeholder:"Select a service"})}),e.jsx(W,{children:j.map(u=>e.jsxs(w,{value:u.id,children:[u.name," (",u.pricingModel,")"]},u.id))})]})]}),N&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Select Category"}),e.jsxs(H,{value:V,onValueChange:I,disabled:!x||!A.length,children:[e.jsx(J,{className:"w-full",children:e.jsx(K,{placeholder:"Select a category"})}),e.jsx(W,{children:A.map(u=>e.jsx(w,{value:u.categoryId,children:u.categoryName},u.categoryId))})]}),!A.length&&x&&e.jsx("p",{className:"text-xs text-red-500",children:"No categories available for this service"})]})]}),e.jsx(Es,{onSubmit:i,onCancel:()=>d(!1),initialData:v,isSubmitting:g})]})})}function Ds({open:t,onOpenChange:d,onConfirm:i,title:n,description:c,isLoading:g=!1}){return e.jsx(Me,{open:t,onOpenChange:d,children:e.jsxs(ke,{children:[e.jsxs(Te,{children:[e.jsx(Le,{children:n}),e.jsx(ns,{children:c})]}),e.jsxs(cs,{children:[e.jsx(f,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(f,{variant:"destructive",onClick:i,disabled:g,children:g?"Deleting...":"Delete"})]})]})})}function Ms({breadcrumbItems:t,title:d,context:i,productsCount:n,totalValue:c,onCreate:g}){const j=ss();return e.jsxs("div",{className:"space-y-4",children:[e.jsx(ms,{items:t}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(f,{variant:"outline",size:"icon",onClick:()=>j(-1),children:e.jsx(xs,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(q,{className:"w-8 h-8 text-primary"}),e.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:d})]}),i.type!=="all"&&(i.isLoading?e.jsx("div",{className:"h-5 w-64 bg-gray-200 rounded animate-pulse"}):i.name?e.jsx("p",{className:"text-muted-foreground",children:i.type==="category"?`Managing products in "${i.name}" category`:`Managing products for "${i.name}" service`}):null),e.jsxs("div",{className:"flex items-center space-x-6 mt-2 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"w-4 h-4"}),e.jsx("span",{children:n===-1?"Loading...":`${n} Products`})]}),n>0&&e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("span",{children:["Total Value: Rs. ",c.toFixed(2)]})})]})]}),e.jsxs(f,{onClick:g,className:"bg-primary hover:bg-primary/90",children:[e.jsx(Fe,{className:"mr-2 h-4 w-4"}),"Add New Product"]})]})]})}function ks({viewMode:t,onViewModeChange:d,itemsPerPage:i,onItemsPerPageChange:n,sortBy:c,onSortChange:g,searchQuery:j,onSearchChange:r}){return e.jsx(_,{children:e.jsxs(F,{className:"p-4 flex items-center justify-between gap-4",children:[e.jsx("div",{className:"flex items-center space-x-3 flex-1",children:e.jsxs("div",{className:"relative w-64",children:[e.jsx(gs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(oe,{placeholder:"Search products...",value:j,onChange:x=>r(x.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(H,{value:c,onValueChange:g,children:[e.jsxs(J,{className:"w-40",children:[e.jsx(hs,{className:"w-4 h-4 mr-2"}),e.jsx(K,{})]}),e.jsxs(W,{children:[e.jsx(w,{value:"name",children:"Sort by Name"}),e.jsx(w,{value:"price",children:"Sort by Price"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground whitespace-nowrap",children:"Show:"}),e.jsxs(H,{value:i.toString(),onValueChange:x=>n(Number(x)),children:[e.jsx(J,{className:"w-20",children:e.jsx(K,{})}),e.jsxs(W,{children:[e.jsx(w,{value:"5",children:"5"}),e.jsx(w,{value:"10",children:"10"}),e.jsx(w,{value:"15",children:"15"}),e.jsx(w,{value:"20",children:"20"})]})]})]}),e.jsxs("div",{className:"flex items-center border rounded-md p-1",children:[e.jsx(f,{variant:t==="grid"?"default":"ghost",size:"sm",onClick:()=>d("grid"),children:e.jsx(Ss,{className:"w-4 h-4"})}),e.jsx(f,{variant:t==="list"?"default":"ghost",size:"sm",onClick:()=>d("list"),children:e.jsx(ws,{className:"w-4 h-4"})})]})]})]})})}function Ts({searchQuery:t,contextType:d,onCreate:i}){return e.jsx(_,{children:e.jsxs(F,{className:"text-center py-16",children:[e.jsx(q,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:t?`No products found matching "${t}"`:d==="category"?"No products found under this category":d==="service"?"No products found under this service":"No products found"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:t?"Try adjusting your search terms":"Get started by adding your first product"}),!t&&e.jsxs(f,{onClick:i,className:"bg-primary hover:bg-primary/90",children:[e.jsx(Fe,{className:"mr-2 h-4 w-4"}),"Add Your First Product"]})]})})}function Ls({product:t,onEdit:d,onDelete:i}){return e.jsx(_,{className:"group hover:shadow-md transition-all duration-200",children:e.jsxs(F,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-lg bg-primary text-primary-foreground font-semibold text-lg",children:t.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground text-lg group-hover:text-primary transition-colors",children:t.name}),e.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:["Rs. ",e.jsx("span",{className:"text-xl font-bold text-green-600",children:t.price!==void 0?t.price.toFixed(2):"0.00"})]})]})]}),e.jsxs(ps,{children:[e.jsx(fs,{asChild:!0,children:e.jsx(f,{variant:"ghost",size:"sm",className:"opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(rs,{className:"w-4 h-4"})})}),e.jsxs(js,{align:"end",children:[e.jsxs(Ce,{onClick:d,children:[e.jsx(Ae,{className:"w-4 h-4 mr-2"}),"Edit Product"]}),e.jsx(vs,{}),e.jsxs(Ce,{onClick:i,className:"text-red-600 focus:text-red-600",children:[e.jsx(_e,{className:"w-4 h-4 mr-2"}),"Delete Product"]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[t.categoryName&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(us,{className:"w-4 h-4 text-orange-500"}),e.jsx(X,{variant:"outline",className:"bg-orange-50 text-orange-700 border-orange-200",children:t.categoryName})]}),t.serviceName&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(q,{className:"w-4 h-4 text-blue-500"}),e.jsx(X,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:t.serviceName})]})]})]})})}function _s({product:t,onEdit:d,onDelete:i}){return e.jsx(_,{children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"group flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4 flex-1",children:[e.jsx("div",{className:"flex items-center justify-center w-10 h-10 rounded-lg bg-primary text-primary-foreground font-semibold",children:t.name.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-foreground group-hover:text-primary transition-colors",children:t.name}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[e.jsx("div",{className:"flex items-center space-x-1",children:e.jsxs("span",{className:"font-bold text-green-600",children:["Rs. ",t.price!==void 0?t.price.toFixed(2):"0.00"]})}),t.categoryName&&e.jsx(X,{variant:"outline",className:"bg-orange-50 text-orange-700 border-orange-200",children:t.categoryName}),t.serviceName&&e.jsx(X,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:t.serviceName})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{variant:"outline",size:"sm",onClick:d,children:e.jsx(Ae,{className:"w-4 h-4"})}),e.jsx(f,{variant:"outline",size:"sm",onClick:i,className:"text-red-600 hover:text-red-700 hover:border-red-200",children:e.jsx(_e,{className:"w-4 h-4"})})]})]})})})}const we=()=>e.jsx(_,{className:"group hover:shadow-md transition-all duration-200",children:e.jsxs(F,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-gray-200 animate-pulse"}),e.jsxs("div",{children:[e.jsx("div",{className:"h-6 w-32 bg-gray-200 rounded animate-pulse mb-2"}),e.jsx("div",{className:"h-8 w-24 bg-gray-200 rounded animate-pulse"})]})]}),e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded animate-pulse"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"w-20 h-6 bg-gray-200 rounded-full animate-pulse"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"w-24 h-6 bg-gray-200 rounded-full animate-pulse"})]})]})]})}),Ie=()=>e.jsx(_,{children:e.jsx(F,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4 flex-1",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-200 animate-pulse"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"h-5 w-40 bg-gray-200 rounded animate-pulse mb-2"}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[e.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"h-6 w-16 bg-gray-200 rounded-full animate-pulse"}),e.jsx("div",{className:"h-6 w-20 bg-gray-200 rounded-full animate-pulse"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded animate-pulse"}),e.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded animate-pulse"})]})]})})});function Fs(){const{toast:t}=as(),{state:d}=De(),{serviceId:i,categoryId:n}=ts(),c=d==null?void 0:d.idType,[g,j]=o.useState([]),[r,x]=o.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10}),[M,V]=o.useState(!0),[I,z]=o.useState(!1),[v,C]=o.useState([]),[N,A]=o.useState([]),[u,de]=o.useState(!1),[$,me]=o.useState(!1),[$e,B]=o.useState(!1),[Re,U]=o.useState(!1),[Oe,Z]=o.useState(!1),[y,Q]=o.useState(null),[ee,Ve]=o.useState(""),[se,ze]=o.useState(""),[k,Be]=o.useState("grid"),[ae,Ue]=o.useState("name"),[R,Ge]=o.useState(""),[Ye,ue]=o.useState(!1),[xe,G]=o.useState(!1),ge=o.useMemo(()=>{if(c==="category"&&n){const s=N.find(a=>a.categoryId===n);return{type:"category",name:s==null?void 0:s.categoryName,isLoading:!$}}else if(c==="service"&&i){const s=v.find(a=>a.id===i);return{type:"service",name:s==null?void 0:s.name,isLoading:!u}}else return{type:"all",isLoading:!1}},[c,i,n,N,v,$,u]),te=o.useMemo(()=>{const s=[...g];return s.sort((a,l)=>{switch(ae){case"name":return a.name.localeCompare(l.name);case"price":return(a.price||0)-(l.price||0);default:return 0}}),s},[g,ae]),T=o.useCallback(async(s,a)=>{var l,m;z(!0),V(s===1&&!g.length);try{let p=`${S.GET_ALL_PRODUCTS()}`,P={page:s,limit:a,offset:(s-1)*a};R&&(P.search=R),c==="category"&&n?(p=`${S.GET_ALL_PRODUCT_BY_CATEGORY_ID()}`,P.categoryId=n):c==="service"&&i&&(p=`${S.GET_ALL_PRODUCT_BY_SERVICE_ID()}`,P.serviceId=i);const O=await L.get(p,{params:P}),fe=O.data.data.map(b=>{const ie=b.categoryId||b.CategoryId,ne=b.serviceId;let Y=b.categoryName,E=b.serviceName;if(c==="category"&&n){const h=N.find(D=>D.categoryId===n);h&&(Y=h.categoryName,E=h.serviceName)}if(c==="service"&&i){const h=v.find(D=>D.id===i);h&&(E=h.name)}if(!Y&&ie){const h=N.find(D=>D.categoryId===ie);h&&(Y=h.categoryName,E||(E=h.serviceName))}if(!E&&ne){const h=v.find(D=>D.id===ne);h&&(E=h.name)}return{id:b.productId||b.id,name:b.productName||b.name,price:b.price??0,categoryId:ie,serviceId:ne,categoryName:Y,serviceName:E}});j(fe);const je=((l=O.data.pagination)==null?void 0:l.total)||O.data.total||O.data.totalCount||((m=O.data.meta)==null?void 0:m.total)||fe.length,es=Math.max(1,Math.ceil(je/a));x({currentPage:s,totalPages:es,totalItems:je,itemsPerPage:a})}catch(p){console.error("Error fetching products:",p),t({title:"Error",description:"Failed to load products",variant:"destructive"}),j([]),x(P=>({...P,totalItems:0,totalPages:1}))}finally{V(!1),z(!1)}},[c,i,n,t,N,v,R]);o.useEffect(()=>{let s=!0;return(async()=>{try{const[l,m]=await Promise.all([L.get(`${S.GET_ALL_SERVICES()}`),L.get(`${S.GET_ALL_CATEGORIES_BY_SERVICE_NAMES()}`)]);s&&(C(l.data.data),de(!0),A(m.data.data),me(!0))}catch(l){s&&(console.error("Error fetching initial data:",l),t({title:"Error",description:"Failed to load services and categories",variant:"destructive"}),de(!0),me(!0))}})(),()=>{s=!1}},[t]),o.useEffect(()=>{u&&$&&T(r.currentPage,r.itemsPerPage)},[u,$,T,r.currentPage,r.itemsPerPage]);const re=s=>{x(a=>({...a,currentPage:s}))},qe=s=>{x(a=>({...a,itemsPerPage:s,currentPage:1}))},He=s=>{Ge(s),x(a=>({...a,currentPage:1}))},Je=async s=>{G(!0);try{let a,l;if(c==="category"&&n)a=n;else if(c==="service"&&i)l=i;else{if(!ee){t({title:"Error",description:"Please select a service first",variant:"destructive"});return}const m=v.find(p=>p.id===ee);if(!m){t({title:"Error",description:"Selected service not found",variant:"destructive"});return}if(m.pricingModel==="per_item"){if(!se){t({title:"Error",description:"Please select a category for this service",variant:"destructive"});return}a=se}else l=m.id}await L.post(`${S.CREATE_PRODUCT()}`,{name:s.name,price:s.price,...a&&{categoryId:a},...l&&{serviceId:l}}),t({title:"Success",description:"Product created successfully"}),B(!1),x(m=>({...m,currentPage:1})),T(1,r.itemsPerPage)}catch(a){console.error("Error creating product:",a),t({title:"Error",description:"Failed to create product",variant:"destructive"})}finally{G(!1)}},Ke=async(s,a)=>{G(!0);try{await L.put(`${S.UPDATE_PRODUCT()}`,{name:a.name,price:a.price},{params:{productId:s}}),t({title:"Success",description:"Product updated successfully"}),U(!1),T(r.currentPage,r.itemsPerPage)}catch(l){console.error("Error updating product:",l),t({title:"Error",description:"Failed to update product",variant:"destructive"})}finally{G(!1)}},We=async()=>{if(y){ue(!0);try{await L.delete(`${S.DELETE_PRODUCT()}`,{params:{productId:y.id}}),t({title:"Success",description:"Product deleted successfully"}),Z(!1),g.length===1&&r.currentPage>1?(x(s=>({...s,currentPage:s.currentPage-1})),T(r.currentPage-1,r.itemsPerPage)):T(r.currentPage,r.itemsPerPage)}catch(s){console.error("Error deleting product:",s),t({title:"Error",description:"Failed to delete product",variant:"destructive"})}finally{ue(!1)}}},he=s=>{Q(s),Z(!0)},Xe=o.useMemo(()=>{const s=[{label:"Services",to:"/config/services"}];if(c==="category"&&n){const a=N.find(m=>m.categoryId===n),l=v.find(m=>m.name===(a==null?void 0:a.serviceName));return[...s,{label:"Categories",to:`/config/categories/${(l==null?void 0:l.id)||""}`},{label:"Products",to:`/config/products/${n}`}]}else return[...s,{label:"Products",to:`/config/products${i?`/${i}`:""}`}]},[c,n,i,N,v]),Ze=o.useMemo(()=>te.reduce((s,a)=>s+(a.price||0),0),[te]),pe=M||!u||!$,Qe=o.useMemo(()=>{const s=[],a=r.totalPages,l=r.currentPage;if(a<=1)return[1];if(s.push(1),a<=5)for(let m=2;m<=a;m++)s.push(m);else{let m=Math.max(2,l-1),p=Math.min(a-1,l+1);l<=3?(m=2,p=4):l>=a-2&&(m=a-3,p=a-1),m>2&&s.push("...");for(let P=m;P<=p;P++)s.push(P);p<a-1&&s.push("..."),s.includes(a)||s.push(a)}return s},[r.totalPages,r.currentPage]);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ms,{breadcrumbItems:Xe,title:"Products",context:ge,productsCount:pe?-1:r.totalItems,totalValue:Ze,onCreate:()=>B(!0)}),e.jsx(ks,{viewMode:k,onViewModeChange:Be,itemsPerPage:r.itemsPerPage,onItemsPerPageChange:qe,sortBy:ae,onSortChange:Ue,searchQuery:R,onSearchChange:He}),pe?e.jsx("div",{className:k==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6":"space-y-4",children:Array.from({length:r.itemsPerPage}).map((s,a)=>k==="grid"?e.jsx(we,{},a):e.jsx(Ie,{},a))}):g.length===0?e.jsx(Ts,{searchQuery:R,contextType:ge.type,onCreate:()=>B(!0)}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:k==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6":"space-y-4",children:I?Array.from({length:r.itemsPerPage}).map((s,a)=>k==="grid"?e.jsx(we,{},a):e.jsx(Ie,{},a)):te.map(s=>k==="grid"?e.jsx(Ls,{product:s,onEdit:()=>{Q(s),U(!0)},onDelete:()=>he(s)},s.id):e.jsx(_s,{product:s,onEdit:()=>{Q(s),U(!0)},onDelete:()=>he(s)},s.id))}),e.jsxs("div",{className:"flex items-center mt-6 p-4 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",r.totalItems>0?(r.currentPage-1)*r.itemsPerPage+1:0," to ",Math.min(r.currentPage*r.itemsPerPage,r.totalItems)," of ",r.totalItems," products"]}),e.jsx("div",{className:"flex-1 flex justify-center",children:e.jsx(Ns,{children:e.jsxs(ys,{children:[e.jsx(le,{children:e.jsx(Ps,{onClick:s=>{s.preventDefault(),r.currentPage>1&&re(r.currentPage-1)},className:`cursor-pointer ${r.currentPage===1||I?"pointer-events-none opacity-50":"hover:bg-accent"}`})}),Qe.map((s,a)=>e.jsx(le,{children:s==="..."?e.jsx("span",{className:"px-3 py-2 text-sm",children:"..."}):e.jsx(bs,{onClick:l=>{l.preventDefault(),re(s)},isActive:r.currentPage===s,className:`cursor-pointer ${I?"pointer-events-none opacity-50":"hover:bg-accent"}`,children:s})},`${s}-${a}`)),e.jsx(le,{children:e.jsx(Cs,{onClick:s=>{s.preventDefault(),r.currentPage<r.totalPages&&re(r.currentPage+1)},className:`cursor-pointer ${r.currentPage===r.totalPages||I?"pointer-events-none opacity-50":"hover:bg-accent"}`})})]})})})]})]}),e.jsx(Se,{open:$e,onOpenChange:B,onSubmit:Je,title:"Add New Product",isSubmitting:xe,services:v,categories:N,selectedService:ee,setSelectedService:Ve,selectedCategory:se,setSelectedCategory:ze,showServiceCategorySelect:!c}),e.jsx(Se,{open:Re,onOpenChange:U,onSubmit:s=>{y&&Ke(y.id,s)},initialData:y?{name:y.name,price:y.price??0}:void 0,title:"Edit Product",isSubmitting:xe}),e.jsx(Ds,{open:Oe,onOpenChange:Z,onConfirm:We,title:"Delete Product",description:`Are you sure you want to delete "${y==null?void 0:y.name}"? This action cannot be undone.`,isLoading:Ye})]})}function la(){const{state:t}=De(),d=t==null?void 0:t.idType;return console.log(d),e.jsx(is,{children:e.jsx("div",{className:"space-y-4",children:e.jsx(Fs,{})})})}export{la as default};
