import{r as m,u as T,j as e,b as N,J as S}from"./index-ByY07t5U.js";import{B as C}from"./button-DBciqQcI.js";import{I as b}from"./input-DcxO3ESS.js";import{S as D,a as L,b as _,c as R,d as F}from"./select-DSUhFaX8.js";import{C as w,a as M,b as I,e as P,c as E,d as z}from"./card-DrHBsbjm.js";import{F as G,a as x,b as p,c as g,d as h,e as j}from"./form-D1pnXXWo.js";import{u as V,z as l,t as J}from"./index-pvnq_pFp.js";import"./index-DjrpyVfh.js";import"./Combination-DHf6tu9R.js";import"./index-Dxwkp90n.js";import"./index-DDlNMbpf.js";import"./label-CtRxIZG0.js";const k=5*1024*1024,A=["image/jpeg","image/jpg","image/png","image/webp"],q=l.object({name:l.string().min(1,"Name is required"),description:l.string().min(10,"Description must be at least 10 characters"),pricingModel:l.string().min(1,"Pricing model is required"),image:l.any().refine(r=>r instanceof File,"Please upload an image").refine(r=>(r==null?void 0:r.size)<=k,"Max image size is 5MB").refine(r=>A.includes(r==null?void 0:r.type),"Only .jpg, .jpeg, .png and .webp formats are supported")}),H=r=>new Promise((u,o)=>{const i=new FileReader;i.readAsDataURL(r),i.onload=()=>u(i.result),i.onerror=f=>o(f)});function ae(){const r=m.useRef(null),u=T(),[o,i]=m.useState([]),[f,v]=m.useState(!1),t=V({resolver:J(q),defaultValues:{name:"",description:"",pricingModel:"",image:void 0}}),y=async()=>{var s,n;try{v(!0);const a=await N.get("/getAllServices");console.log("result ",a),i(a.data.data||[])}catch(a){console.error("Fetch error:",a),S("Failed to fetch services",{description:((n=(s=a.response)==null?void 0:s.data)==null?void 0:n.message)||"Try again later"})}finally{v(!1)}};m.useEffect(()=>{y()},[]);const B=async s=>{var n,a;try{const c=await H(s.image),d={name:s.name,description:s.description,pricingModel:s.pricingModel,imageBase64:c};await N.post("/createService",d,{headers:{"Content-Type":"application/json"}}),S("Service Added",{description:"Service has been added successfully!"}),t.reset(),r.current&&(r.current.value=""),y()}catch(c){console.error("Submission error:",c),S("Submission Failed",{description:((a=(n=c.response)==null?void 0:n.data)==null?void 0:a.message)||"Something went wrong"})}};return e.jsx("div",{className:"min-h-screen bg-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8 text-center text-gray-800",children:"Add New Laundry Service"}),e.jsxs(w,{className:"mb-10 shadow-md",children:[e.jsxs(M,{className:"space-y-1",children:[e.jsx(I,{className:"text-xl font-semibold text-center",children:"Service Information"}),e.jsx(P,{className:"text-center text-gray-500",children:"Fill out the details and add a service"})]}),e.jsx(E,{children:e.jsx(G,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(B),className:"space-y-6",children:[e.jsx(x,{control:t.control,name:"name",render:({field:s})=>e.jsxs(p,{children:[e.jsx(g,{children:"Name"}),e.jsx(h,{children:e.jsx(b,{placeholder:"E.g. Wash & Fold",...s})}),e.jsx(j,{})]})}),e.jsx(x,{control:t.control,name:"description",render:({field:s})=>e.jsxs(p,{children:[e.jsx(g,{children:"Description"}),e.jsx(h,{children:e.jsx(b,{placeholder:"Service description...",...s})}),e.jsx(j,{})]})}),e.jsx(x,{control:t.control,name:"pricingModel",render:({field:s})=>e.jsxs(p,{children:[e.jsx(g,{children:"Pricing Model"}),e.jsxs(D,{onValueChange:s.onChange,defaultValue:s.value,children:[e.jsx(h,{children:e.jsx(L,{children:e.jsx(_,{placeholder:"Choose pricing model"})})}),e.jsxs(R,{children:[e.jsx(F,{value:"per_item",children:"Per Item"}),e.jsx(F,{value:"per_kg",children:"Per Kg"})]})]}),e.jsx(j,{})]})}),e.jsx(x,{control:t.control,name:"image",render:({field:{onChange:s,...n}})=>e.jsxs(p,{children:[e.jsx(g,{children:"Upload Image"}),e.jsx(h,{children:e.jsx(b,{type:"file",accept:A.join(","),onChange:a=>{var d;const c=(d=a.target.files)==null?void 0:d[0];s(c)},ref:r})}),e.jsx(j,{})]})}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx(C,{type:"submit",className:"w-full",children:t.formState.isSubmitting?"Adding...":"Add Service"}),e.jsx(C,{type:"button",disabled:o.length===0,onClick:()=>u("/"),variant:"secondary",className:"w-full",children:"Complete and Go to Home"})]})]})})}),e.jsx(z,{children:e.jsx("p",{className:"text-xs text-gray-500 mx-auto",children:"* JPEG, PNG, WEBP files only. Max size 5MB."})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-gray-700",children:"Available Services"}),f?e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Loading..."}):o.length===0?e.jsx("p",{className:"text-sm text-gray-500 text-center",children:"No services found."}):e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:o.map((s,n)=>e.jsxs(w,{className:"shadow-sm",children:[e.jsxs(M,{children:[e.jsx(I,{className:"text-lg",children:s.name}),e.jsx(P,{children:s.description})]}),e.jsxs(E,{children:[e.jsxs("p",{className:"text-sm mb-2",children:[e.jsx("span",{className:"font-medium",children:"Pricing:"})," ",s.pricingModel]}),e.jsx("img",{src:s.imageBase64,alt:s.name,className:"w-full h-40 object-cover rounded-md"})]})]},n))})]})]})})}export{ae as default};
