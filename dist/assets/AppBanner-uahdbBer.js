import{i as A,r as g,u as P,j as e,b as N,J as C}from"./index-ByY07t5U.js";import{B as v}from"./button-DBciqQcI.js";import{I as u}from"./input-DcxO3ESS.js";import{C as w,a as M,b as T,e as D,c as F,d as R}from"./card-DrHBsbjm.js";import{F as _,a as f,b as h,c as j,d as b,e as S}from"./form-D1pnXXWo.js";import{u as z,z as d,t as G}from"./index-pvnq_pFp.js";import"./label-CtRxIZG0.js";const J=5*1024*1024,B=["image/jpeg","image/jpg","image/png","image/webp"],L=d.object({title:d.string().min(1,"Title is required"),description:d.string().min(10,"Description must be at least 10 characters"),image:d.any().refine(t=>t instanceof File,"Please upload an image").refine(t=>(t==null?void 0:t.size)<=J,"Max image size is 5MB").refine(t=>B.includes(t==null?void 0:t.type),"Only .jpg, .jpeg, .png and .webp formats are supported")}),U=t=>new Promise((n,o)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>n(r.result),r.onerror=m=>o(m)});function X(){const t=A(s=>s.profileStatus.data),n=g.useRef(null),o=P(),[r,m]=g.useState([]),a=z({resolver:G(L),defaultValues:{title:"",description:"",image:void 0}}),y=async()=>{try{const s=await N.get("/getAllAppBanner");m(s.data.data||[])}catch(s){console.error("Failed to fetch banners",s)}};g.useEffect(()=>{y()},[]);const E=async s=>{var p,c;try{const l=await U(s.image),i={title:s.title,description:s.description,fileBase64Image:l},x=await N.post("/createAppBanner",i,{headers:{"Content-Type":"application/json"}});C("Submission Successful",{description:"Your banner was added successfully!"}),a.reset(),n.current&&(n.current.value=""),y()}catch(l){const i=l;C("Submission Failed",{description:((c=(p=i==null?void 0:i.response)==null?void 0:p.data)==null?void 0:c.message)||"Something went wrong"})}},I=()=>{t.configurations.area.isConfigured&&t.configurations.service.isConfigured?o("/"):t.configurations.area.isConfigured?o("/Serv"):o("/area-config")};return e.jsxs("div",{className:"min-h-screen bg-gray-100 py-10 px-4 space-y-10",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs(w,{className:"w-full max-w-md",children:[e.jsxs(M,{className:"space-y-1",children:[e.jsx(T,{className:"text-2xl font-bold text-center",children:"Submit Banner"}),e.jsx(D,{className:"text-center",children:"Provide details and upload an image for the banner"})]}),e.jsx(F,{children:e.jsx(_,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(E),className:"space-y-4",children:[e.jsx(f,{control:a.control,name:"title",render:({field:s})=>e.jsxs(h,{children:[e.jsx(j,{children:"Title"}),e.jsx(b,{children:e.jsx(u,{placeholder:"Enter title",...s,disabled:a.formState.isSubmitting})}),e.jsx(S,{})]})}),e.jsx(f,{control:a.control,name:"description",render:({field:s})=>e.jsxs(h,{children:[e.jsx(j,{children:"Description"}),e.jsx(b,{children:e.jsx(u,{placeholder:"Enter description",...s,disabled:a.formState.isSubmitting})}),e.jsx(S,{})]})}),e.jsx(f,{control:a.control,name:"image",render:({field:{onChange:s,value:p,...c}})=>e.jsxs(h,{children:[e.jsx(j,{children:"Image"}),e.jsx(b,{children:e.jsx(u,{type:"file",accept:B.join(","),disabled:a.formState.isSubmitting,...c,onChange:l=>{var x;const i=(x=l.target.files)==null?void 0:x[0];s(i)},ref:n})}),e.jsx(S,{})]})}),e.jsx(v,{type:"submit",className:"w-full",disabled:a.formState.isSubmitting,children:a.formState.isSubmitting?"Submitting...":"Submit Banner"}),e.jsx(v,{onClick:I,disabled:r.length===0,className:"w-full px-6 py-2 text-white bg-green-600 hover:bg-green-700",children:"Complete"})]})})}),e.jsx(R,{className:"flex justify-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Supported: JPEG, PNG, WEBP (Max 5MB)"})})]})}),e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-700",children:"All Banners"}),r.length===0?e.jsx("p",{className:"text-gray-500",children:"No banners available"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(s=>e.jsxs(w,{children:[e.jsx("img",{src:s.imageUrl,alt:s.title,className:"w-full h-40 object-cover rounded-t-md"}),e.jsxs(F,{children:[e.jsx("h3",{className:"font-bold text-lg",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description})]})]},s.bannerId))})]})]})}export{X as default};
