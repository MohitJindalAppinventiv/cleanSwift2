import{o as E,u as B,r as d,b,A as v,t as m,j as e}from"./index-ByY07t5U.js";import{D as x}from"./DashboardLayout-CorAQK4x.js";import{B as U}from"./BannerForm-X6-0a5N7.js";import{S as o}from"./skeleton-D-G3Wgw9.js";import{B as A}from"./button-DBciqQcI.js";import"./input-DcxO3ESS.js";import"./textarea-CMzAX9ph.js";import"./form-D1pnXXWo.js";import"./index-pvnq_pFp.js";import"./label-CtRxIZG0.js";import"./upload-Dz_LuVq4.js";const y=()=>{const{id:t}=E(),r=B(),[i,p]=d.useState(null),[c,l]=d.useState(!0),[f,u]=d.useState(!1);return d.useEffect(()=>{(async()=>{try{l(!0);const s=await b.get(`${v.GET_ALL_BANNERS()}`);if(!s.data.success)throw new Error(s.data.message||"Failed to fetch banners");const a=s.data.data.find(g=>g.bannerId===t);if(!a){m({title:"Error",description:"Banner not found",variant:"destructive"}),r("/config/app-banner");return}const j={id:a.bannerId,title:a.title,description:a.description,imageUrl:a.imageUrl,isActive:a.enable??a.isActive??!1,createdAt:new Date(a.createdAt._seconds*1e3+a.createdAt._nanoseconds/1e6)};p(j)}catch(s){console.error("Error fetching banner:",s),m({title:s.response.data.message,description:"Failed to load banner data",variant:"destructive"}),r("/config/app-banner")}finally{l(!1)}})()},[t,r]),{banner:i,isLoading:c,isSubmitting:f,handleUpdateBanner:async n=>{try{if(!t)throw new Error("Missing banner ID");u(!0);const s={title:n.title,description:n.description};if(n.imageUrl!==(i==null?void 0:i.imageUrl))if(n.imageUrl.startsWith("data:image"))s.fileBase64Image=n.imageUrl;else{const g=await(await fetch(n.imageUrl)).blob(),N=await new Promise(w=>{const h=new FileReader;h.readAsDataURL(g),h.onload=()=>w(h.result)});s.fileBase64Image=N}const a=await b.put(`${v.UPDATE_BANNER()}`,s,{params:{bannerId:t},headers:{"Content-Type":"application/json"}});if(a.data.success)return m({title:"Success",description:"Banner updated successfully"}),r("/config/app-banner"),!0;throw new Error(a.data.message||"Failed to update banner")}catch(s){return m({title:"Error",description:s instanceof Error?s.message:"Failed to update banner",variant:"destructive"}),!1}finally{u(!1)}}}};function D(){const{banner:t,isLoading:r,handleUpdateBanner:i,isSubmitting:p}=y(),c=B(),l=async f=>{await i(f)&&c("/config/app-banner")};return r?e.jsx(x,{children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{children:[e.jsx(o,{className:"h-8 w-48"}),e.jsx(o,{className:"h-4 w-64 mt-2"})]}),e.jsx("div",{className:"rounded-md border p-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(o,{className:"h-20 w-full"}),e.jsx(o,{className:"h-32 w-full"}),e.jsx(o,{className:"h-20 w-full"})]}),e.jsx(o,{className:"aspect-[16/9] w-full"})]})})]})}):t?e.jsx(x,{children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:"Edit Banner"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Update the promotional banner"})]}),e.jsx("div",{className:"rounded-md border p-6",children:e.jsx(U,{onSave:l,isSubmitting:p,defaultValues:{title:t.title,description:t.description,imageUrl:t.imageUrl,isActive:t.isActive},isEdit:!0})})]})}):e.jsx(x,{children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:"Edit Banner"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Banner not found"})]}),e.jsx(A,{onClick:()=>c("/config/app-banner"),children:"Back to Banners"})]})})}export{D as default};
