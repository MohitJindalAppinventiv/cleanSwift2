import{r as t,j as e,L as O,b as V,J as B,d as z}from"./index-ByY07t5U.js";import{D as J}from"./DashboardLayout-CorAQK4x.js";import{I as Q}from"./input-DcxO3ESS.js";import{T as E,a as M,b as A,c as l,d as $,e as i}from"./table-DrbJVUPK.js";import{B as x}from"./button-DBciqQcI.js";import{B as U}from"./badge-B45milNp.js";import{T as _,D as q,a as G,b as K,c as W,d as X}from"./dialog-DND4cV_M.js";import{P as Y,a as Z,b as F,c as ee,d as se,e as ae}from"./pagination-C8Rc9njr.js";import{L as te}from"./loader-circle-CHQfb1Hg.js";import{S as u}from"./skeleton-D-G3Wgw9.js";import{C as re}from"./chevron-left-BFqG9IJl.js";import{C as le}from"./chevron-right-Nhb4I_UE.js";import{S as ie,a as ne,b as ce,c as oe,d as w}from"./select-DSUhFaX8.js";import{S as de}from"./search-d2cfHkwq.js";import"./index-Dxwkp90n.js";import"./Combination-DHf6tu9R.js";import"./index-DjrpyVfh.js";import"./index-DDlNMbpf.js";const he=({customers:n,totalPages:o,page:a,setPage:g,fetchData:d,limit:c,setLimit:r})=>{const[h,y]=t.useState(!1);t.useState("");const[C,f]=t.useState(!1),[S,m]=t.useState(null),[p,b]=t.useState(!1),T=s=>{m(s),f(!0)},v=async()=>{if(S){b(!0);try{await V.delete("/deleteUser",{params:{userId:S}}),B.success("User deleted successfully"),d(a,c)}catch(s){z.isAxiosError(s)?(B.error(s.message),console.error(s)):(console.error(s),B.error("Failed to delete user"))}finally{b(!1),f(!1),m(null)}}},N=()=>{if(a>1){const s=a-1;g(s),d(s,c)}},j=()=>{if(a<o){const s=a+1;g(s),d(s,c)}},H=()=>{const D=Math.floor(2.5);let P=Math.max(1,a-D);const k=Math.min(o,P+5-1);k-P+1<5&&(P=Math.max(1,k-5+1));const L=[];for(let I=P;I<=k;I++)L.push(I);return L},R=s=>{g(s),d(s,c)};return e.jsxs("div",{className:"space-y-4",children:[h?e.jsx("div",{className:"text-muted-foreground",children:"Loading users..."}):e.jsxs(e.Fragment,{children:[e.jsxs(E,{children:[e.jsx(M,{children:e.jsxs(A,{children:[e.jsx(l,{children:"User ID"}),e.jsx(l,{children:"Full Name"}),e.jsx(l,{children:"Phone Numbers"}),e.jsx(l,{children:"Status"}),e.jsx(l,{children:"Deleted By"}),e.jsx(l,{className:"text-right",children:"Actions"})]})}),e.jsx($,{children:n==null?void 0:n.map(s=>e.jsxs(A,{children:[e.jsx(i,{children:s.readableUserId}),e.jsx(i,{children:s.fullName}),e.jsxs(i,{children:[s.phoneNumber,s.alternateNumber?` / ${s.alternateNumber}`:""]}),e.jsx(i,{children:e.jsx(U,{variant:s.isActive?"default":"destructive",children:s.isActive?"Active":"Inactive"})}),e.jsx(i,{children:e.jsx(U,{variant:s.isActive?"default":"destructive",children:s.isActive?"NA":s.deletedByAdmin?"Admin":"User"})}),e.jsxs(i,{className:"text-right flex gap-2 justify-end",children:[e.jsx(x,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx(O,{to:`/customer-details/${s.id}`,children:"View"})}),e.jsx(x,{variant:"ghost",size:"sm",className:"text-red-600",onClick:()=>T(s.id),disabled:!s.isActive,children:e.jsx(_,{})})]})]},s.id))})]}),e.jsx("div",{className:"flex flex-col sm:flex-row items-center justify-end gap-4 mt-6",children:e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(Y,{className:"mx-0 w-auto",children:e.jsxs(Z,{className:"gap-1",children:[e.jsx(F,{children:e.jsx(ee,{onClick:()=>N(),className:`${a===1?"pointer-events-none opacity-50 bg-gray-100":"cursor-pointer bg-white hover:bg-[#9B87F5] hover:text-white transition-colors"} border rounded-md px-3 py-2`})}),H().map((s,D)=>e.jsx(F,{children:e.jsx(se,{isActive:a===s,onClick:()=>R(s),className:`h-9 w-9 flex items-center justify-center border rounded-md text-sm transition-colors
              ${a===s?"bg-[#9B87F5] text-white border-[#9B87F5]":"bg-white text-gray-700 border-gray-300 hover:bg-[#9B87F5] hover:text-white"}`,children:s})},D)),e.jsx(F,{children:e.jsx(ae,{onClick:()=>j(),className:`${a===o||o===0?"pointer-events-none opacity-50 bg-gray-100":"cursor-pointer bg-white hover:bg-[#9B87F5] hover:text-white transition-colors"} border rounded-md px-3 py-2`})})]})})})})]}),e.jsx(q,{open:C,onOpenChange:f,children:e.jsxs(G,{children:[e.jsx(K,{children:e.jsx(W,{children:"Confirm Deletion"})}),e.jsx("div",{children:"Are you sure you want to delete this user?"}),e.jsxs(X,{className:"gap-2",children:[e.jsx(x,{variant:"outline",onClick:()=>f(!1),children:"Cancel"}),e.jsxs(x,{onClick:v,disabled:p,className:"bg-red-600 text-white hover:bg-red-700",children:[p&&e.jsx(te,{className:"animate-spin mr-2 h-4 w-4"}),"Confirm"]})]})]})})]})},xe=()=>e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Customers"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Manage your customer database"})]})}),me=async({page:n=1,limit:o=20,search:a="",status:g="all"})=>{var d,c;try{const r=await V.get("/getAllUser",{params:{page:n,limit:o,search:a,status:g}});return console.log(r),r.data.data}catch(r){throw console.error("Error fetching users:",r),new Error(((c=(d=r==null?void 0:r.response)==null?void 0:d.data)==null?void 0:c.message)||"Failed to fetch users. Please try again later.")}},je=({rows:n=5})=>e.jsxs("div",{className:"space-y-4",children:[e.jsxs(E,{children:[e.jsx(M,{children:e.jsxs(A,{children:[e.jsx(l,{children:"User ID"}),e.jsx(l,{children:"Full Name"}),e.jsx(l,{children:"Phone Numbers"}),e.jsx(l,{children:"Status"}),e.jsx(l,{children:"Deleted By"}),e.jsx(l,{className:"text-right",children:"Actions"})]})}),e.jsx($,{children:Array.from({length:n}).map((o,a)=>e.jsxs(A,{children:[e.jsx(i,{children:e.jsx(u,{className:"h-4 w-20"})}),e.jsx(i,{children:e.jsx(u,{className:"h-4 w-32"})}),e.jsx(i,{children:e.jsx(u,{className:"h-4 w-28"})}),e.jsx(i,{children:e.jsx(u,{className:"h-5 w-16 rounded-full"})}),e.jsx(i,{children:e.jsx(u,{className:"h-5 w-16 rounded-full"})}),e.jsxs(i,{className:"text-right flex gap-2 justify-end",children:[e.jsx(u,{className:"h-8 w-12 rounded-md"}),e.jsx(u,{className:"h-8 w-8 rounded-md"})]})]},a))})]}),e.jsxs("div",{className:"flex justify-center gap-6 items-center mt-4",children:[e.jsxs(x,{disabled:!0,variant:"outline",children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Previous"]}),e.jsx(u,{className:"h-4 w-24"}),e.jsxs(x,{disabled:!0,variant:"outline",children:["Next",e.jsx(le,{className:"ml-2 h-4 w-4"})]})]})]}),Fe=()=>{const[n,o]=t.useState(""),[a,g]=t.useState([]),[d,c]=t.useState(!1),[r,h]=t.useState(1),[y,C]=t.useState(10),[f,S]=t.useState(1),[m,p]=t.useState("all"),b=async(v=r,N=y)=>{try{c(!0);const j=await me({search:n,page:v,limit:N,status:m});console.log("data in customers",j),g(j.profiles),h(j.pagination.currentPage),S(j.pagination.totalPages),console.log(f)}catch(j){console.error("Failed to fetch users",j)}finally{c(!1)}};t.useEffect(()=>{b()},[n,m]),t.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[r]);const T=v=>{o(v.target.value),h(1)};return e.jsx(J,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(xe,{}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(x,{variant:m==="all"?"default":"outline",onClick:()=>{p("all"),h(1)},children:"All"}),e.jsx(x,{variant:m==="active"?"default":"outline",onClick:()=>{p("active"),h(1)},children:"Active"}),e.jsx(x,{variant:m==="inactive"?"default":"outline",onClick:()=>{p("inactive"),h(1)},children:"Inactive"})]}),e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(de,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(Q,{type:"search",placeholder:"Search customers...",className:"pl-8 w-[300px]",value:n,onChange:T})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Rows per page:"}),e.jsxs(ie,{value:y.toString(),onValueChange:v=>{const N=parseInt(v,10);C(N),h(1),b(1,N)},children:[e.jsx(ne,{className:"w-20",children:e.jsx(ce,{placeholder:y})}),e.jsxs(oe,{children:[e.jsx(w,{value:"10",children:"10"}),e.jsx(w,{value:"15",children:"15"}),e.jsx(w,{value:"20",children:"20"}),e.jsx(w,{value:"25",children:"25"}),e.jsx(w,{value:"50",children:"50"})]})]})]})]}),d?e.jsx(je,{}):e.jsx(he,{customers:a,totalPages:f,page:r,setPage:h,fetchData:b,limit:y,setLimit:C})]})})};export{Fe as default};
