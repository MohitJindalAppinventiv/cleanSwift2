import{r as n,b as f,t as o,j as e}from"./index-ByY07t5U.js";import{D as Ee}from"./DashboardLayout-CorAQK4x.js";import{B as d}from"./button-DBciqQcI.js";import{I as b}from"./input-DcxO3ESS.js";import{T as V}from"./textarea-CMzAX9ph.js";import{S as re}from"./switch-C1bv9KX7.js";import{T as ce,D as E,a as D,b as k,c as Q,d as T,e as De}from"./dialog-DND4cV_M.js";import{T as ke,a as Qe,b as X,c as Z}from"./tabs-jpblMaOk.js";import{L as h}from"./label-CtRxIZG0.js";import{S as l}from"./skeleton-D-G3Wgw9.js";import{P as oe}from"./plus-DsKVMYgt.js";import{S as de}from"./square-pen-BFr-I4KV.js";import"./index-DDlNMbpf.js";import"./index-Dxwkp90n.js";import"./Combination-DHf6tu9R.js";import"./index-n1Mj4gwV.js";import"./index-DjrpyVfh.js";function We(){const[U,he]=n.useState("faqs"),[L,A]=n.useState([]),[O,R]=n.useState({}),[x,_]=n.useState(null),[z,w]=n.useState({faqs:!1,policies:!1,about:!1}),[F,ee]=n.useState(null),[u,se]=n.useState(null),[M,te]=n.useState(null),[g,ae]=n.useState(!1),[S,I]=n.useState({open:!1,id:null}),[ue,Y]=n.useState(!1),[C,B]=n.useState(null),[p,P]=n.useState({question:"",answer:"",order:0}),[me,G]=n.useState(!1),[m,ie]=n.useState(null),[c,y]=n.useState({title:"",content:"",version:"",effectiveDate:"",isPublished:!1}),[xe,H]=n.useState(!1),[r,N]=n.useState({title:"",content:"",sections:[],isPublished:!1}),[pe,J]=n.useState(!1),[K,W]=n.useState(null),[j,q]=n.useState({title:"",content:"",order:0});n.useEffect(()=>{je(U)},[U]);const je=async s=>{switch(s){case"faqs":L.length===0&&(w(t=>({...t,faqs:!0})),await ve(),w(t=>({...t,faqs:!1})));break;case"policies":!O.privacy&&!O.terms&&(w(t=>({...t,policies:!0})),await fe(),w(t=>({...t,policies:!1})));break;case"about":x||(w(t=>({...t,about:!0})),await ge(),w(t=>({...t,about:!1})));break}},ve=async()=>{var s,t,a;try{const i=await f.get("/getAllFAQs"),v=(s=i.data)!=null&&s.data&&Array.isArray(i.data.data)?i.data.data:[];A(v),v.length===0&&o({title:"Info",description:"No FAQs found. You can create one.",variant:"default"})}catch(i){console.error("FAQ Fetch Error:",i),A([]),o({title:"Error",description:((a=(t=i.response)==null?void 0:t.data)==null?void 0:a.error)||"Failed to fetch FAQs. Please try again.",variant:"destructive"})}},fe=async()=>{var s,t;try{try{const a=await f.get("/getPolicy?type=privacy");(s=a.data)!=null&&s.data&&R(i=>({...i,privacy:a.data.data}))}catch(a){console.error("Privacy Policy Fetch Error:",a)}try{const a=await f.get("/getPolicy?type=terms");(t=a.data)!=null&&t.data&&R(i=>({...i,terms:a.data.data}))}catch(a){console.error("Terms Policy Fetch Error:",a)}}catch(a){console.error("General Policy Fetch Error:",a)}},ge=async()=>{var s;try{const t=await f.get("/getAbout");(s=t.data)!=null&&s.data&&_(t.data.data)}catch(t){console.error("About Fetch Error:",t),_(null)}},$=(s,t)=>{var v;let a=t,i=[];if((v=s.response)!=null&&v.data){const{error:Pe,details:qe}=s.response.data;a=Pe||a,i=qe||[]}else s.message&&(a=s.message);o({title:"Error",description:i.length>0?i.join(", "):a,variant:"destructive"})},ne=s=>{s?(B(s),P({question:s.question,answer:s.answer,order:s.order})):(B(null),P({question:"",answer:"",order:0})),Y(!0)},be=async()=>{var s,t;if(!p.question.trim()||!p.answer.trim()){o({title:"Validation Error",description:"Question and answer are required and must be non-empty strings",variant:"destructive"});return}try{if(ee(C?C.id:"new"),C){const a=await f.put(`/updateFAQ?id=${C.id}`,p);(s=a.data)!=null&&s.data&&(A(i=>i.map(v=>v.id===C.id?{...v,...a.data.data}:v)),o({title:"Success",description:"FAQ item updated successfully"}))}else{const a=await f.post("/createFAQ",p);(t=a.data)!=null&&t.data&&(A(i=>[...i,a.data.data]),o({title:"Success",description:"FAQ item created successfully"}))}Y(!1),B(null)}catch(a){$(a,"Failed to save FAQ")}finally{ee(null)}},ye=async s=>{try{se(s),await f.delete(`/deleteFAQ?id=${s}`),A(t=>t.filter(a=>a.id!==s)),o({title:"Success",description:"FAQ item deleted successfully"}),I({open:!1,id:null})}catch(t){$(t,"Failed to delete FAQ")}finally{se(null)}},Ne=(s,t)=>{ie(s),y(t?{title:t.title||"",content:t.content,version:t.version,effectiveDate:t.effectiveDate,isPublished:t.isPublished}:{title:"",content:"",version:"",effectiveDate:"",isPublished:!1}),G(!0)},we=async()=>{var s;if(!c.content.trim()||!c.version.trim()||!c.effectiveDate.trim()){o({title:"Validation Error",description:"Content, version, and effective date are required and must be non-empty",variant:"destructive"});return}if(!m){o({title:"Validation Error",description:"Policy type is required",variant:"destructive"});return}try{te(m);const t={...c,type:m},a=await f.post("/createOrUpdatePolicy",t);(s=a.data)!=null&&s.data&&(R(i=>({...i,[m]:a.data.data})),o({title:"Success",description:"Policy updated successfully"})),G(!1),ie(null)}catch(t){$(t,"Failed to save policy")}finally{te(null)}},Fe=s=>{N(s?{title:s.title||"",content:s.content,sections:s.sections.map(t=>({...t})),isPublished:s.isPublished}:{title:"",content:"",sections:[],isPublished:!1}),H(!0)},Se=async()=>{var s;if(!r.content.trim()){o({title:"Validation Error",description:"Main content is required and must be non-empty",variant:"destructive"});return}if(r.sections.some(t=>!t.title.trim()||!t.content.trim())){o({title:"Validation Error",description:"All sections must have non-empty title and content",variant:"destructive"});return}try{ae(!0);const t=await f.post("/createOrUpdateAbout",r);(s=t.data)!=null&&s.data&&(_(t.data.data),o({title:"Success",description:"About content updated successfully"})),H(!1)}catch(t){$(t,"Failed to save about content")}finally{ae(!1)}},le=s=>{if(s!==void 0){const t=r.sections[s];q({title:t.title,content:t.content,order:t.order}),W(s)}else q({title:"",content:"",order:r.sections.length+1}),W(null);J(!0)},Ce=()=>{if(!j.title.trim()||!j.content.trim()){o({title:"Validation Error",description:"Section title and content are required and must be non-empty",variant:"destructive"});return}const s=[...r.sections];K!==null?s[K]={...j}:s.push({...j,id:`section_${Date.now()}_${s.length}`}),N({...r,sections:s}),J(!1),W(null)},Ae=s=>{const t=r.sections.filter((a,i)=>i!==s);N({...r,sections:t})};return e.jsx(Ee,{children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:"Content Management"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage FAQs, Policies, and About content for your application"})]}),e.jsx("div",{className:"rounded-md border p-6",children:e.jsxs(ke,{value:U,onValueChange:he,className:"space-y-6",children:[e.jsxs(Qe,{children:[e.jsx(X,{value:"faqs",children:"FAQs"}),e.jsx(X,{value:"policies",children:"Policies"}),e.jsx(X,{value:"about",children:"About"})]}),e.jsxs(Z,{value:"faqs",className:"space-y-4",children:[e.jsxs(d,{onClick:()=>ne(),className:"flex items-center gap-2",disabled:!!F||!!u,children:[e.jsx(oe,{className:"h-4 w-4"}),F==="new"?"Adding...":"Add New FAQ"]}),z.faqs?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[...Array(3)].map((s,t)=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-4 space-y-2",children:[e.jsx(l,{className:"h-6 w-full"}),e.jsx(l,{className:"h-4 w-full"}),e.jsx(l,{className:"h-4 w-1/2"}),e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(l,{className:"h-8 w-8 rounded-md"}),e.jsx(l,{className:"h-8 w-8 rounded-md"})]})]},t))}):L.length===0?e.jsx("p",{className:"text-gray-500",children:"No FAQs found. Create one to get started."}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:L.map(s=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-4 space-y-2",children:[e.jsx("h3",{className:"font-semibold truncate",children:s.question}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-3",children:s.answer}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Order: ",s.order]}),e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>ne(s),disabled:F===s.id||u===s.id,"aria-label":`Edit FAQ: ${s.question}`,children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>I({open:!0,id:s.id}),disabled:F===s.id||u===s.id,"aria-label":`Delete FAQ: ${s.question}`,children:e.jsx(ce,{className:"h-4 w-4 text-red-500"})})]})]},s.id))}),e.jsx(E,{open:ue,onOpenChange:s=>!s&&Y(!1),children:e.jsxs(D,{children:[e.jsx(k,{children:e.jsx(Q,{children:C?"Edit FAQ":"Create FAQ"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"faq-question",children:"Question (required)"}),e.jsx(b,{id:"faq-question",value:p.question,onChange:s=>P({...p,question:s.target.value}),placeholder:"Enter question"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"faq-answer",children:"Answer (required)"}),e.jsx(V,{id:"faq-answer",value:p.answer,onChange:s=>P({...p,answer:s.target.value}),placeholder:"Enter answer"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"faq-order",children:"Order (optional)"}),e.jsx(b,{id:"faq-order",type:"number",value:p.order,onChange:s=>P({...p,order:parseInt(s.target.value)||0}),placeholder:"Enter order"})]})]}),e.jsx(T,{children:e.jsx(d,{onClick:be,disabled:!!F,children:F?"Saving...":"Save"})})]})}),e.jsx(E,{open:S.open,onOpenChange:s=>I({open:s,id:s?S.id:null}),children:e.jsxs(D,{children:[e.jsxs(k,{children:[e.jsx(Q,{children:"Delete FAQ"}),e.jsx(De,{children:"Are you sure you want to delete this FAQ item? This action cannot be undone."})]}),e.jsxs(T,{children:[e.jsx(d,{variant:"outline",onClick:()=>I({open:!1,id:null}),disabled:!!u,children:"Cancel"}),e.jsx(d,{variant:"destructive",onClick:()=>S.id&&ye(S.id),disabled:u===S.id,children:u===S.id?"Deleting...":"Delete"})]})]})})]}),e.jsxs(Z,{value:"policies",className:"space-y-8",children:[z.policies?e.jsx("div",{className:"space-y-8",children:[...Array(2)].map((s,t)=>e.jsxs("div",{className:"border p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(l,{className:"h-6 w-32"}),e.jsx(l,{className:"h-9 w-20"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"h-4 w-full"}),e.jsx(l,{className:"h-4 w-3/4"}),e.jsx(l,{className:"h-4 w-2/3"}),e.jsx(l,{className:"h-4 w-1/2"}),e.jsx(l,{className:"h-12 w-full"})]})]},t))}):["privacy","terms"].map(s=>{const t=O[s],a=M===s;return e.jsxs("div",{className:"border p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-xl font-semibold",children:[s.charAt(0).toUpperCase()+s.slice(1)," Policy"]}),e.jsx(d,{onClick:()=>Ne(s,t),disabled:!!M||!!u,children:a?"Saving...":t?"Edit":"Create"})]}),t?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Title:"})," ",t.title||"Untitled"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Version:"})," ",t.version]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Effective Date:"})," ",t.effectiveDate]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Published:"})," ",t.isPublished?"Yes":"No"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Content Preview:"}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-3",children:t.content})]})]}):e.jsxs("p",{className:"text-gray-500",children:["No ",s,' policy found. Click "Create" to add one.']})]},s)}),e.jsx(E,{open:me,onOpenChange:s=>!s&&G(!1),children:e.jsxs(D,{className:"max-w-2xl",children:[e.jsx(k,{children:e.jsxs(Q,{children:[m&&O[m]?"Update":"Create"," ",(m==null?void 0:m.charAt(0).toUpperCase())+(m==null?void 0:m.slice(1))," Policy"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"policy-title",children:"Title (optional)"}),e.jsx(b,{id:"policy-title",value:c.title,onChange:s=>y({...c,title:s.target.value}),placeholder:"Enter title"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"policy-content",children:"Content (required)"}),e.jsx(V,{id:"policy-content",value:c.content,onChange:s=>y({...c,content:s.target.value}),placeholder:"Enter policy content",rows:8})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"policy-version",children:"Version (required)"}),e.jsx(b,{id:"policy-version",value:c.version,onChange:s=>y({...c,version:s.target.value}),placeholder:"e.g., 1.0"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"policy-effectiveDate",children:"Effective Date (required)"}),e.jsx(b,{id:"policy-effectiveDate",type:"date",value:c.effectiveDate,onChange:s=>y({...c,effectiveDate:s.target.value})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{htmlFor:"policy-isPublished",children:"Published"}),e.jsx(re,{id:"policy-isPublished",checked:c.isPublished,onCheckedChange:s=>y({...c,isPublished:s})})]})]}),e.jsx(T,{children:e.jsx(d,{onClick:we,disabled:!!M,children:M?"Saving...":"Save"})})]})})]}),e.jsxs(Z,{value:"about",className:"space-y-4",children:[e.jsx(d,{onClick:()=>Fe(x),disabled:g||!!u,children:g?"Saving...":x?"Edit About Content":"Create About Content"}),z.about?e.jsxs("div",{className:"border p-4 rounded-lg space-y-4",children:[e.jsx(l,{className:"h-6 w-32"}),e.jsx(l,{className:"h-4 w-full"}),e.jsx(l,{className:"h-4 w-full"}),e.jsx(l,{className:"h-4 w-1/2"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{className:"h-4 w-24"}),e.jsx(l,{className:"h-16 w-full"})]})]}):x?e.jsxs("div",{className:"border p-4 rounded-lg space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:x.title||"About Us"}),e.jsx("p",{className:"text-gray-600",children:x.content}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:"Published:"})," ",x.isPublished?"Yes":"No"]}),e.jsx("h4",{className:"font-medium",children:"Sections"}),x.sections.length>0?x.sections.map(s=>e.jsxs("div",{className:"border-t pt-2",children:[e.jsx("h5",{className:"font-semibold",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600",children:s.content}),e.jsxs("div",{className:"text-xs",children:["Order: ",s.order]})]},s.id||`${s.title}-${s.order}`)):e.jsx("p",{className:"text-gray-500",children:"No sections added."})]}):e.jsx("p",{className:"text-gray-500",children:'No about content found. Click "Create" to add one.'}),e.jsx(E,{open:xe,onOpenChange:s=>!s&&H(!1),children:e.jsxs(D,{className:"max-w-3xl max-h-[80vh] overflow-y-auto",children:[e.jsx(k,{children:e.jsxs(Q,{children:[x?"Update":"Create"," About Content"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"about-title",children:"Title (optional)"}),e.jsx(b,{id:"about-title",value:r.title,onChange:s=>N({...r,title:s.target.value}),placeholder:"Enter title"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"about-content",children:"Main Content (required)"}),e.jsx(V,{id:"about-content",value:r.content,onChange:s=>N({...r,content:s.target.value}),placeholder:"Enter main about content",rows:6})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{htmlFor:"about-isPublished",children:"Published"}),e.jsx(re,{id:"about-isPublished",checked:r.isPublished,onCheckedChange:s=>N({...r,isPublished:s})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"font-medium",children:"Sections"}),e.jsxs(d,{variant:"outline",onClick:()=>le(),className:"flex items-center gap-2",disabled:g||!!u,children:[e.jsx(oe,{className:"h-4 w-4"})," Add Section"]})]}),r.sections.length>0?e.jsx("div",{className:"space-y-4",children:r.sections.map((s,t)=>e.jsxs("div",{className:"border p-3 rounded-md flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:s.content}),e.jsxs("div",{className:"text-xs",children:["Order: ",s.order]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>le(t),disabled:g||!!u,"aria-label":`Edit section: ${s.title}`,children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>Ae(t),disabled:g||!!u,"aria-label":`Delete section: ${s.title}`,children:e.jsx(ce,{className:"h-4 w-4 text-red-500"})})]})]},t))}):e.jsx("p",{className:"text-gray-500",children:"No sections added yet."})]})]}),e.jsx(T,{className:"mt-4",children:e.jsx(d,{onClick:Se,disabled:g,children:g?"Saving...":"Save"})})]})}),e.jsx(E,{open:pe,onOpenChange:s=>!s&&J(!1),children:e.jsxs(D,{children:[e.jsx(k,{children:e.jsx(Q,{children:K!==null?"Edit Section":"Add Section"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(h,{htmlFor:"section-title",children:"Title (required)"}),e.jsx(b,{id:"section-title",value:j.title,onChange:s=>q({...j,title:s.target.value}),placeholder:"Enter section title"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"section-content",children:"Content (required)"}),e.jsx(V,{id:"section-content",value:j.content,onChange:s=>q({...j,content:s.target.value}),placeholder:"Enter section content"})]}),e.jsxs("div",{children:[e.jsx(h,{htmlFor:"section-order",children:"Order (optional)"}),e.jsx(b,{id:"section-order",type:"number",value:j.order,onChange:s=>q({...j,order:parseInt(s.target.value)||0}),placeholder:"Enter order"})]})]}),e.jsx(T,{children:e.jsx(d,{onClick:Ce,disabled:g||!!u,children:"Save Section"})})]})})]})]})})]})})}export{We as default};
